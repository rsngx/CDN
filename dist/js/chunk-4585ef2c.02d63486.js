(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4585ef2c","chunk-c8882352"],{"06c5":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));r("a630"),r("fb6a"),r("b0c0"),r("d3b7"),r("ac1f"),r("25f0"),r("3ca3");var a=r("6b75");function o(e,t){if(e){if("string"===typeof e)return Object(a["a"])(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Object(a["a"])(e,t):void 0}}},2909:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var a=r("6b75");function o(e){if(Array.isArray(e))return Object(a["a"])(e)}r("a4d3"),r("e01a"),r("d28b"),r("a630"),r("d3b7"),r("3ca3"),r("ddb0");function n(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var i=r("06c5");function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e){return o(e)||n(e)||Object(i["a"])(e)||c()}},"46ad":function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"f",(function(){return i})),r.d(t,"e",(function(){return c})),r.d(t,"c",(function(){return l})),r.d(t,"g",(function(){return u})),r.d(t,"l",(function(){return s})),r.d(t,"a",(function(){return d})),r.d(t,"h",(function(){return p})),r.d(t,"d",(function(){return m})),r.d(t,"k",(function(){return f})),r.d(t,"i",(function(){return h})),r.d(t,"j",(function(){return b}));var a=r("b775"),o={add:"mr/add_report",query:"mr/query",update:"mr/update_report",statistic:"mr/report_statistical",overview:"mr/detail_report",details:"mr/report_detail_query",updateInfo:"mr/update_info",getRole:"mr/role",getPersonnelInfo:"mr/approval_personnel_query",getDailyByPerson:"mr/approval_mr_query",approveDaily:"mr/approval_mr_update",approveBatch:"mr/approval_mr_update_batch"};function n(e){return Object(a["b"])({url:o.approveBatch,method:"post",params:e})}function i(e){return Object(a["b"])({url:o.getPersonnelInfo,method:"post",params:e})}function c(e){return Object(a["b"])({url:o.getDailyByPerson,method:"post",params:e})}function l(e){return Object(a["b"])({url:o.approveDaily,method:"post",params:e})}function u(e){return Object(a["b"])({url:o.getRole,method:"post",params:e})}function s(e){return Object(a["b"])({url:o.updateInfo,method:"post",params:e})}function d(e){return Object(a["b"])({url:o.add,method:"post",params:e})}function p(e){return Object(a["b"])({url:o.overview,method:"post",params:e})}function m(e){return Object(a["b"])({url:o.details,method:"post",params:e})}function f(e){return Object(a["b"])({url:o.update,method:"post",params:e})}function h(e){return Object(a["b"])({url:o.query,method:"post",params:e})}function b(e){return Object(a["b"])({url:o.statistic,method:"post",params:e})}},"49a4":function(e,t,r){},"6b75":function(e,t,r){"use strict";function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}r.d(t,"a",(function(){return a}))},"8ac3":function(e,t,r){"use strict";r.d(t,"i",(function(){return n})),r.d(t,"b",(function(){return i})),r.d(t,"h",(function(){return c})),r.d(t,"m",(function(){return l})),r.d(t,"j",(function(){return u})),r.d(t,"l",(function(){return s})),r.d(t,"g",(function(){return d})),r.d(t,"n",(function(){return p})),r.d(t,"q",(function(){return m})),r.d(t,"p",(function(){return f})),r.d(t,"e",(function(){return h})),r.d(t,"f",(function(){return b})),r.d(t,"k",(function(){return v})),r.d(t,"o",(function(){return y})),r.d(t,"a",(function(){return g})),r.d(t,"d",(function(){return _})),r.d(t,"r",(function(){return j})),r.d(t,"c",(function(){return w}));var a=r("b775"),o={query:"supplier/query",add:"supplier/add",deleteData:"supplier/del",update:"supplier/update",submit:"supplier/submit",audit:"supplier/audit",reject:"supplier/reject",getDicByType:"dict/getByType",getDicAll:"dict/all",getProvice:"org/province",getVendor:"/org/vendor",getAnylisisList:"/supplier/multi_statistics",getProjectStatic:"/supplier/project_statistical",getStatustics:"/supplier/level_statistical",getProjectsDetail:"/supplier/detail",getToDo:"/supplier/todo",getHnStatustics:"/supplier/Hn_level_statistical",addScore:"/score/add_score",updateScore:"/score/update_score",getPscore:"/score/detail_employees_score",getVscore:"/score/detail_supplier_score"};function n(e){return Object(a["b"])({url:o.getProjectStatic,method:"post",params:e})}function i(e){return Object(a["b"])({url:o.addScore,method:"post",params:e})}function c(e){return Object(a["b"])({url:o.getAnylisisList,method:"post",params:e})}function l(e){return Object(a["b"])({url:o.getToDo,method:"post",params:e})}function u(e){return Object(a["b"])({url:o.getProjectsDetail,method:"post",params:e})}function s(e){return Object(a["b"])({url:o.getStatustics,method:"post",params:e})}function d(e){return Object(a["b"])({url:o.getHnStatustics,method:"post",params:e})}function p(e){return Object(a["b"])({url:o.getVendor,method:"get",params:e})}function m(e){return Object(a["b"])({url:o.submit,method:"post",params:e})}function f(e){return Object(a["b"])({url:o.reject,method:"post",params:e})}function h(e){return Object(a["b"])({url:o.getDicAll,method:"get",params:e})}function b(e){return Object(a["b"])({url:o.getDicByType,method:"get",params:e})}function v(e){return Object(a["b"])({url:o.getProvice,method:"get",params:e})}function y(e){return Object(a["b"])({url:o.query,method:"post",params:e})}function g(e){return Object(a["b"])({url:o.add,method:"post",params:e})}function _(e){return Object(a["b"])({url:o.deleteData,method:"post",params:e})}function j(e){return Object(a["b"])({url:o.update,method:"post",params:e})}function w(e){return Object(a["b"])({url:o.audit,method:"post",params:e})}},"97a1":function(e,t,r){"use strict";r("49a4")},b0c0b:function(e,t,r){"use strict";r("bce6")},bce6:function(e,t,r){},be0e:function(e,t,r){},d87c:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-card",{attrs:{bordered:!1}},[t("a-form",{staticStyle:{"margin-bottom":"16px"},attrs:{layout:"inline"}},[t("a-row",{attrs:{gutter:12,type:"flex",align:"middle"}},[t("a-col",{attrs:{md:4,lg:3}},[t("a-form-item",{attrs:{label:"Package数"}},[t("span",{staticStyle:{color:"#409EFF"}},[e._v(e._s(e.getWtrCount))])])],1),t("a-col",{attrs:{md:10,lg:11}},[t("a-form-item",{attrs:{label:"注意事项",required:""}},[t("span",{staticStyle:{"font-weight":"bolder"}},[e._v('"序号"仅为填写的顺序，和日期无关，请按顺序填写！')])])],1),t("a-col",{attrs:{md:8,lg:7,offset:2}},[t("div",{staticStyle:{float:"right"}},[t("a-form-item",{attrs:{label:"日报时间"}},[t("a-month-picker",{staticStyle:{width:"120px"},attrs:{format:e.dateFormat},on:{change:e.onChange},model:{value:e.dailyTime,callback:function(t){e.dailyTime=t},expression:"dailyTime"}})],1),t("a-button",{staticStyle:{"margin-left":"8px","margin-top":"4px",float:"right"},attrs:{type:"primary"},on:{click:function(t){return e.init()}}},[e._v("查询")])],1)])],1)],1),t("a-table",{attrs:{bordered:"",dataSource:e.dataSource,columns:e.columns,pagination:!1,size:"middle",scroll:{x:!0}},scopedSlots:e._u([{key:"job_description",fn:function(r,a){return[a.editable?[t("editable-cell",{ref:"job_description_".concat(a.key),attrs:{formType:"textarea",defaultEditable:a.editable,autoSave:!0,placeholder:"请输入",value:r,text:r,decoratorOptions:e.rules.job_description},on:{"on-blur":function(t){return e.onBlur(a.key,"job_description",t)}}})]:[t("a-popover",{attrs:{content:r}},[t("span",{style:e.fittedClass},[e._v(e._s(r))])])]]}},{key:"job_category",fn:function(r,a){return[t("editable-cell",{ref:"job_category_".concat(a.key),attrs:{formType:"select",defaultEditable:a.editable,autoSave:!1,message:"请选择",value:a.job_category,text:a.job_category,decoratorOptions:e.rules.job_category,allowClearSelect:!0},on:{selectChange:function(t){return e.onCellChange(a.key,"job_category",t)}}},[t("a-select-option",{attrs:{value:"BigData/AI/GIS"}},[e._v("BigData/AI/GIS")]),t("a-select-option",{attrs:{value:"Project Coordination"}},[e._v("Project Coordination")]),t("a-select-option",{attrs:{value:"Project Management"}},[e._v("Project Management")]),t("a-select-option",{attrs:{value:"Requirement Analytic"}},[e._v("Requirement Analytic")]),t("a-select-option",{attrs:{value:"Software Development"}},[e._v("Software Development")]),t("a-select-option",{attrs:{value:"SW&HW Maintenance&Testing"}},[e._v("SW&HW Maintenance&Testing")])],1)]}},{key:"working_place",fn:function(r,a){return[t("editable-cell",{ref:"working_place_".concat(a.key),attrs:{text:r,defaultEditable:a.editable,autoSave:!1,value:r,decoratorOptions:e.rules.working_place},on:{valueChange:function(t){return e.onCellChange(a.key,"working_place",t)}}})]}},{key:"operation",fn:function(r,a){return[t("div",{staticClass:"editable-row-operations"},[a.editable?t("span",[t("a",{on:{click:function(){return e.save(a)}}},[e._v("保存")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"确定取消?"},on:{confirm:function(){return e.cancel(a.key)}}},[t("a",[e._v("取消")])])],1):t("span",[t("a",{attrs:{disabled:""!==e.editingKey},on:{click:function(){return e.edit(a.key)}}},[t("a-icon",{attrs:{type:"edit"}})],1)])])]}}])})],1)},o=[],n=r("5530"),i=r("2909"),c=(r("99af"),r("4de4"),r("7db0"),r("d3b7"),r("159b"),r("de08")),l=r("46ad"),u=r("8ac3"),s=r("c32d"),d=r.n(s),p=[{title:"月份",dataIndex:"daily_time",width:80},{title:"序号",dataIndex:"serial_number",width:50},{title:"Package",dataIndex:"mr_level",width:140},{title:"工作简要描述",dataIndex:"job_description",scopedSlots:{customRender:"job_description"},width:210},{title:"工作类别",dataIndex:"job_category",width:240,scopedSlots:{customRender:"job_category"}},{title:"地点",dataIndex:"working_place",width:100,scopedSlots:{customRender:"working_place"}},{title:"操作",dataIndex:"operation",width:120,scopedSlots:{customRender:"operation"}}],m={name:"DailyReport",components:{EditableCell:c["default"]},data:function(){return{signData:[],mulData:[],dateFormat:"YYYY-MM",dataSource:[],count:0,columns:p,fields:["job_description","job_category","working_place"],userId:0,dailyTime:d()(),rules:{job_description:{rules:[{required:!0,message:"请输入工作内容"}]},job_category:{rules:[{required:!0,message:"请选择"}]},working_place:{rules:[{required:!0,message:"请输入"}]}},clientWidth:1200,editingKey:"",levelData:[],hasRemind:!1}},created:function(){this.userId=this.$store.state.user.info.user_id,this.init()},mounted:function(){var e=this;this.clientWidth=document.body.clientWidth,window.onresize=function(){return function(){e.$nextTick((function(){e.clientWidth=document.body.clientWidth}))}()},Object(u["f"])({dict_type:"level"}).then((function(t){if("ok"===t.state){var r=[];t.data.forEach((function(e){r.push(e.dic_value)})),e.levelData=r}}))},computed:{getWtrCount:function(){return this.dataSource.filter((function(e){return""!==e.job_description})).length},fittedClass:function(){var e=this.clientWidth>1650?650:this.clientWidth>1500?480:this.clientWidth>1400?410:210;return this.columns.forEach((function(t){"job_description"===t.dataIndex&&(t.width=e+20)})),{overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",display:"inline-block",width:e+"px"}}},methods:{moment:d.a,onChange:function(e,t){},init:function(e){var t=this;this.dataSource=[],e&&(this.dailyTime=e);var r=d()(this.dailyTime).format("L").split("/")[1],a=d()(this.dailyTime).year();Object(l["i"])({user_id:this.userId,monthly_report_time:"P".concat(r,".Y").concat(a)}).then((function(e){var o=new Date(a,r,0).getDate(),n={};d()(t.dailyTime).add(1,"month").date(5).diff(d()(),"days")<0||d()(t.dailyTime).add(1,"month").date(5).diff(d()(),"days")+1>=d()().daysInMonth()?t.columns=p.filter((function(e){return"operation"!==e.dataIndex})):t.columns=p;for(var i=0;i<o;i++){var c=i+1;n={key:c,daily_time:d()(t.dailyTime).format("YYYY-MM"),serial_number:c,mr_level:"",job_description:"",job_category:"",working_place:""},e.list.forEach((function(e){n.serial_number===e.serial_number&&(n.job_description=e.job_description,n.job_category=e.job_category,n.working_place=e.working_place,n.mr_level=e.mr_level,n.id=e.id)})),t.dataSource.push(n)}}))},onCellChange:function(e,t,r){var a=Object(i["a"])(this.dataSource),o=a.find((function(t){return t.key===e}));o&&(o[t]=r,this.dataSource=a)},onBlur:function(e,t,r){var a=this;this.validateRow(e,this.fields,(function(t,r){t||a.fields.forEach((function(t){var o="".concat(t,"_").concat(e);a.$refs[o].setValue(r[t]),a.$forceUpdate()}))}))},edit:function(e){var t=Object(i["a"])(this.dataSource),r=t.filter((function(t){return e===t.key}))[0];this.editingKey=e,r&&(r.editable=!0,this.dataSource=t)},save:function(e){var t=this;if(!0!==this.hasRemind){!1===this.hasRemind&&(this.hasRemind=!0,setTimeout((function(){t.hasRemind=!1}),3e3));var r=e.key;setTimeout((function(){t.validateRow(r,t.fields,(function(e,a){if(!e){var o=Object(i["a"])(t.dataSource),c=o.find((function(e){return r===e.key}));if(Object.assign(c,a),c.user_id||(c.user_id=t.userId),!c.monthly_report_time){var u=d()(c.daily_time).format("L").split("/")[1],s=d()(c.daily_time).year();c.monthly_report_time="P".concat(u,".Y").concat(s)}try{c.ip_address=returnCitySN["cip"]}catch(m){c.ip_address="0.0.0.0"}delete c.editable,t.editingKey="";var p=Object(n["a"])({},c);delete p.key,delete p.daily_time,p.fingerId=localStorage.getItem("fingerId"),"undefined"===typeof p.job_category&&(p.job_category=""),c.id?Object(l["k"])(p).then((function(e){"ok"===e.state&&(t.$message.success("更新成功",2),t.init())})):Object(l["a"])(p).then((function(e){"ok"===e.state&&(t.$message.success("添加成功",2),t.init())}))}}))}),500)}},cancel:function(e){var t=Object(i["a"])(this.dataSource),r=t.filter((function(t){return e===t.key}))[0];this.editingKey="",r&&(delete r.editable,this.dataSource=t)},validateRow:function(e,t,r){var a=this,o={},n=!1;t.forEach((function(t){var r="".concat(t,"_").concat(e),i=a.$refs[r].validate();o[t]=i.value,i.success||(n=!0)})),r(n,o)}}},f=m,h=(r("b0c0b"),r("97a1"),r("2877")),b=Object(h["a"])(f,a,o,!1,null,"ebe763b8",null);t["default"]=b.exports},de08:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"editable-cell"},[e.editable?t("div",{class:["editable-cell-input-wrapper",e.singleEdit?"single-edit":""]},[t("a-form",{attrs:{form:e.form}},[t("a-form-item",{staticClass:"no-validate",attrs:{colon:!1}},[e.showFormItem("input")?t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:e.decorator,expression:"decorator"}],attrs:{placeholder:e.placeholder,autocomplete:"off"},on:{change:e.handleChange}}):e._e(),e.showFormItem("textarea")?t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:e.decorator,expression:"decorator"}],attrs:{placeholder:"placeholder",autocomplete:"off","auto-size":!0},on:{change:e.handleBlur,blur:e.handleBlur}}):e._e(),e.showFormItem("number")?t("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:e.decorator,expression:"decorator"}],attrs:{min:e.min,max:e.max,placeholder:e.placeholder}}):e._e(),e.showFormItem("switch")?t("a-switch",{directives:[{name:"decorator",rawName:"v-decorator",value:e.decorator,expression:"decorator"}],attrs:{placeholder:e.placeholder,value:e.value},on:{change:e.handleChange}}):e._e(),e.showFormItem("datePicker")?t("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:e.decorator,expression:"decorator"}],attrs:{showTime:e.showTime,format:e.format,placeholder:e.placeholder}}):e._e(),e.showFormItem("rangePicker")?t("a-range-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:e.decorator,expression:"decorator"}],attrs:{showTime:e.showTime,format:e.format,placeholder:e.placeholder}}):e._e(),e.showFormItem("monthPicker")?t("a-month-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:e.decorator,expression:"decorator"}],attrs:{showTime:e.showTime,format:e.format,placeholder:e.placeholder}}):e._e(),e.showFormItem("select")?t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:e.decorator,expression:"decorator"}],attrs:{placeholder:e.placeholder,mode:e.selectMode,labelInValue:e.selectLabelInValue,allowClear:e.allowClearSelect},on:{change:e.handleChange}},[e._t("default")],2):e._e(),e.showFormItem("autoComplete")?t("a-auto-complete",{directives:[{name:"decorator",rawName:"v-decorator",value:e.decorator,expression:"decorator"}],attrs:{placeholder:e.placeholder,optionLabelProp:"text",disabled:e.notEdit},on:{search:e.handleSearch}},[t("template",{slot:"dataSource"},[e._t("default")],2)],2):e._e()],1)],1),e.singleEdit?t("a-icon",{staticClass:"editable-cell-icon-check",attrs:{type:"check"},on:{click:function(t){return e.check(!0)}}}):e._e()],1):t("div",{class:["editable-cell-text-wrapper",e.singleEdit?"single-edit":""]},[e._v(" "+e._s(e.getText||" ")+" "),e.singleEdit?t("a-icon",{staticClass:"editable-cell-icon",attrs:{type:"edit"},on:{click:e.edit}}):e._e()],1)])},o=[],n=r("5530"),i=(r("a9e3"),{data:function(){return{form:this.$form.createForm(this),editable:this.defaultEditable}},props:{text:{type:[Number,String,Array,Object]},value:{message:{type:[Number,String,Array,Object],default:""}},formType:{validator:function(e){return-1!==["input","textarea","number","switch","datePicker","rangePicker","select","monthPicker","autoComplete"].indexOf(e)},default:"input"},decoratorOptions:{type:[Array,Object]},min:{type:Number,default:-1/0},max:{type:Number,default:1/0},placeholder:{type:String,default:"请输入"},singleEdit:{type:Boolean,default:!1},defaultEditable:{type:Boolean,default:!1},autoSave:{type:Boolean,default:!1},format:{type:String,default:"YYYY-MM-DD"},showTime:{type:[Boolean,Object],default:!1},notEdit:{type:Boolean,default:!1},selectMode:{type:String,default:void 0},selectLabelInValue:{type:Boolean,default:!1},selectDefaultValue:{type:Array},allowClearSelect:{type:Boolean,default:!1}},computed:{getText:function(){return"function"===typeof this.text?this.text():this.text},decorator:{get:function(){if(this.decoratorOptions){var e=["formName",Object(n["a"])({initialValue:this.value},this.decoratorOptions)];return e}var t=["formName",{initialValue:this.value}];return t},set:function(e){this.decorator[1].initialValue=e}}},watch:{defaultEditable:function(e){this.editable=e}},methods:{showFormItem:function(e){return this.formType===e},handleChange:function(e){this.autoSave&&("input"===this.formType||"textarea"===this.formType?this.$emit("valueChange",e.target.value):"select"===this.formType&&this.$emit("selectChange",e))},handleBlur:function(e){"textarea"===this.formType&&this.$emit("on-blur",e.target.value)},handleSearch:function(e){this.$emit("autoCompleteSearch",e)},validate:function(){var e=this,t={success:!1,value:""};return this.form.validateFields((function(r,a){r||(e.editable?t.value=a.formName:t.value=e.getText,t.success=!0)})),t},setValue:function(e){this.form.setFieldsValue({formName:e})},check:function(e){var t=this;this.form.validateFields((function(r,a){r||(e&&(t.editable=!1),t.$emit("valueChange",a.formName))}))},edit:function(){this.editable=!0,this.decorator=this.value}}}),c=i,l=(r("f2d9"),r("2877")),u=Object(l["a"])(c,a,o,!1,null,"731854c2",null);t["default"]=u.exports},f2d9:function(e,t,r){"use strict";r("be0e")}}]);