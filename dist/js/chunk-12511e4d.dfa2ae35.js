(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-12511e4d","chunk-78ec9eec","chunk-3095e62e"],{3926:function(e,t,r){"use strict";r("e29a")},"3eca1":function(e,t,r){},"46ad":function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"f",(function(){return i})),r.d(t,"e",(function(){return s})),r.d(t,"c",(function(){return c})),r.d(t,"g",(function(){return l})),r.d(t,"l",(function(){return u})),r.d(t,"a",(function(){return d})),r.d(t,"h",(function(){return p})),r.d(t,"d",(function(){return m})),r.d(t,"k",(function(){return h})),r.d(t,"i",(function(){return f})),r.d(t,"j",(function(){return b}));var n=r("b775"),o={add:"mr/add_report",query:"mr/query",update:"mr/update_report",statistic:"mr/report_statistical",overview:"mr/detail_report",details:"mr/report_detail_query",updateInfo:"mr/update_info",getRole:"mr/role",getPersonnelInfo:"mr/approval_personnel_query",getDailyByPerson:"mr/approval_mr_query",approveDaily:"mr/approval_mr_update",approveBatch:"mr/approval_mr_update_batch"};function a(e){return Object(n["b"])({url:o.approveBatch,method:"post",params:e})}function i(e){return Object(n["b"])({url:o.getPersonnelInfo,method:"post",params:e})}function s(e){return Object(n["b"])({url:o.getDailyByPerson,method:"post",params:e})}function c(e){return Object(n["b"])({url:o.approveDaily,method:"post",params:e})}function l(e){return Object(n["b"])({url:o.getRole,method:"post",params:e})}function u(e){return Object(n["b"])({url:o.updateInfo,method:"post",params:e})}function d(e){return Object(n["b"])({url:o.add,method:"post",params:e})}function p(e){return Object(n["b"])({url:o.overview,method:"post",params:e})}function m(e){return Object(n["b"])({url:o.details,method:"post",params:e})}function h(e){return Object(n["b"])({url:o.update,method:"post",params:e})}function f(e){return Object(n["b"])({url:o.query,method:"post",params:e})}function b(e){return Object(n["b"])({url:o.statistic,method:"post",params:e})}},"8ac3":function(e,t,r){"use strict";r.d(t,"i",(function(){return a})),r.d(t,"b",(function(){return i})),r.d(t,"h",(function(){return s})),r.d(t,"m",(function(){return c})),r.d(t,"j",(function(){return l})),r.d(t,"l",(function(){return u})),r.d(t,"g",(function(){return d})),r.d(t,"n",(function(){return p})),r.d(t,"q",(function(){return m})),r.d(t,"p",(function(){return h})),r.d(t,"e",(function(){return f})),r.d(t,"f",(function(){return b})),r.d(t,"k",(function(){return g})),r.d(t,"o",(function(){return y})),r.d(t,"a",(function(){return v})),r.d(t,"d",(function(){return _})),r.d(t,"r",(function(){return w})),r.d(t,"c",(function(){return j}));var n=r("b775"),o={query:"supplier/query",add:"supplier/add",deleteData:"supplier/del",update:"supplier/update",submit:"supplier/submit",audit:"supplier/audit",reject:"supplier/reject",getDicByType:"dict/getByType",getDicAll:"dict/all",getProvice:"org/province",getVendor:"/org/vendor",getAnylisisList:"/supplier/multi_statistics",getProjectStatic:"/supplier/project_statistical",getStatustics:"/supplier/level_statistical",getProjectsDetail:"/supplier/detail",getToDo:"/supplier/todo",getHnStatustics:"/supplier/Hn_level_statistical",addScore:"/score/add_score",updateScore:"/score/update_score",getPscore:"/score/detail_employees_score",getVscore:"/score/detail_supplier_score"};function a(e){return Object(n["b"])({url:o.getProjectStatic,method:"post",params:e})}function i(e){return Object(n["b"])({url:o.addScore,method:"post",params:e})}function s(e){return Object(n["b"])({url:o.getAnylisisList,method:"post",params:e})}function c(e){return Object(n["b"])({url:o.getToDo,method:"post",params:e})}function l(e){return Object(n["b"])({url:o.getProjectsDetail,method:"post",params:e})}function u(e){return Object(n["b"])({url:o.getStatustics,method:"post",params:e})}function d(e){return Object(n["b"])({url:o.getHnStatustics,method:"post",params:e})}function p(e){return Object(n["b"])({url:o.getVendor,method:"get",params:e})}function m(e){return Object(n["b"])({url:o.submit,method:"post",params:e})}function h(e){return Object(n["b"])({url:o.reject,method:"post",params:e})}function f(e){return Object(n["b"])({url:o.getDicAll,method:"get",params:e})}function b(e){return Object(n["b"])({url:o.getDicByType,method:"get",params:e})}function g(e){return Object(n["b"])({url:o.getProvice,method:"get",params:e})}function y(e){return Object(n["b"])({url:o.query,method:"post",params:e})}function v(e){return Object(n["b"])({url:o.add,method:"post",params:e})}function _(e){return Object(n["b"])({url:o.deleteData,method:"post",params:e})}function w(e){return Object(n["b"])({url:o.update,method:"post",params:e})}function j(e){return Object(n["b"])({url:o.audit,method:"post",params:e})}},a7c5:function(e,t,r){"use strict";r("3eca1")},c0e8:function(e,t,r){"use strict";r.r(t);r("b0c0");var n=function(){var e=this,t=e._self._c;return t("a-card",{attrs:{bordered:!1}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"}},[t("a-row",{attrs:{gutter:40}},[t("a-col",{attrs:{md:6,xxl:4}},[t("a-form-item",{attrs:{label:"填写人"}},[t("a-input",{attrs:{placeholder:"请输入",allowClear:""},model:{value:e.queryItem.name,callback:function(t){e.$set(e.queryItem,"name",t)},expression:"queryItem.name"}})],1)],1),t("a-col",{attrs:{md:6,xxl:4}},[t("a-form-item",{attrs:{label:"时间"}},[t("a-month-picker",{attrs:{format:"YYYY-MM",valueFormat:"YYYY-MM",allowClear:!1},model:{value:e.queryItem.monthly_report_time,callback:function(t){e.$set(e.queryItem,"monthly_report_time",t)},expression:"queryItem.monthly_report_time"}})],1)],1),t("a-col",{attrs:{md:6,xxl:4}},[t("a-form-item",{attrs:{label:"公司"}},[t("a-select",{attrs:{placeholder:"请选择",allowClear:""},model:{value:e.queryItem.vendor,callback:function(t){e.$set(e.queryItem,"vendor",t)},expression:"queryItem.vendor"}},e._l(e.vendorOptions,(function(r){return t("a-select-option",{key:r.dept_name},[e._v(e._s(r.dept_name))])})),1)],1)],1),t("a-col",{attrs:{md:6,xxl:4}},[t("a-button",{staticStyle:{"margin-right":"28px"},attrs:{type:"primary",loading:e.loading},on:{click:function(t){return e.$refs.table.refresh(!0)}}},[e._v("查询")])],1)],1)],1)],1),t("a-row",{staticStyle:{"margin-top":"20px"},attrs:{gutter:60}},[t("a-col",{attrs:{xxl:7,md:9}},[t("div",{staticStyle:{"margin-bottom":"8px"}},[t("a-button",{attrs:{type:"primary",disabled:!e.hasSelected},on:{click:e.showModal}},[e._v(" 批量批复 ")]),t("span",{staticStyle:{"margin-left":"8px"}},[e.hasSelected?[e._v(" "+e._s("选择 ".concat(e.selectedRowKeys.length," 项"))+" ")]:e._e()],2),t("span",{staticStyle:{float:"right",color:"#f30808","font-weight":"bold","line-height":"32px"}},[[e._v(" 当前审批时间："+e._s(e.queryItem.monthly_report_time)+" ")]],2)],1),t("s-table",{ref:"table",attrs:{bordered:"",size:"middle",columns:e.columns,data:e.loadData,rowKey:function(e,t){return t},"row-selection":{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange,getCheckboxProps:e.getCheckboxProps,columnTitle:e.hideSelect?"选择":""},pagination:{showLessItems:!0}},scopedSlots:e._u([{key:"name",fn:function(r,n){return[t("a-tooltip",{attrs:{title:"批复完成, 天数>=22"}},[n.poid_cound>=22?t("a-icon",{staticStyle:{"margin-right":"16px"},attrs:{type:"check-circle",theme:"twoTone","two-tone-color":"#52c41a"}}):e._e()],1),t("a-tooltip",{attrs:{title:"17<=天数<22"}},[n.poid_cound>=17&&n.poid_cound<22?t("a-icon",{staticStyle:{"margin-right":"16px"},attrs:{type:"exclamation-circle",theme:"twoTone","two-tone-color":"#ff6666"}}):e._e()],1),t("a",{on:{click:function(t){return e.getDetails(n)}}},[e._v(" "+e._s(r)+" ")])]}}])})],1),t("a-col",{attrs:{xxl:17,md:15}},[t("approval-personal-detail",{ref:"dailyDetail",on:{ok:function(t){return e.$refs.table.refresh(!0)}}})],1),t("approval-modal",{ref:"approvalBatchModal",on:{ok:function(t){return e.$refs.table.refresh(!0)}}})],1)],1)},o=[],a=(r("99af"),r("4de4"),r("d3b7"),r("159b"),r("c32d")),i=r.n(a),s=r("2af9"),c=r("d795"),l=r("e788"),u=r("46ad"),d=r("8ac3"),p=[{align:"center",title:"填写人",dataIndex:"name",key:"name",scopedSlots:{customRender:"name"},width:120},{align:"center",title:"公司",dataIndex:"vendor",key:"vendor"}],m={name:"ApprovalCard",components:{STable:s["b"],ApprovalPersonalDetail:c["default"],ApprovalModal:l["default"]},data:function(){var e=this;return{moment:i.a,loading:!1,queryItem:{name:"",vendor:"",monthly_report_time:i()().subtract(1,"month").format("YYYY-MM")},dataSource:[],visible:!1,columns:p,confirmLoading:!1,selectedRowKeys:[],selectedRows:[],selectedIdCards:[],vendorOptions:[],monthlyReportTimeStr:"",hideSelect:!1,loadData:function(t){e.loading=!0,e.selectedRowKeys=[];var r=e.queryItem.monthly_report_time.split("-")[0],n=e.queryItem.monthly_report_time.split("-")[1];return e.monthlyReportTimeStr="P".concat(n,".Y").concat(r),Object(u["f"])(Object.assign({},t,e.queryItem,{monthly_report_time:e.monthlyReportTimeStr})).then((function(t){var r=t.list;return e.dataSource=t.list.data,e.hideSelect=e.dataSource.filter((function(e){return e.poid_cound>0})).length>0,e.loading=!1,r}))}}},created:function(){var e=this;Object(d["n"])().then((function(t){e.vendorOptions=t.data}))},computed:{hasSelected:function(){return this.selectedRowKeys.length>0}},methods:{onSelectChange:function(e,t){var r=this;this.selectedRows=t,this.selectedRowKeys=e,this.selectedIdCards=[],t.forEach((function(e){r.selectedIdCards.push(e.idcard)}))},getCheckboxProps:function(e){return{props:{disabled:e.poid_cound>0}}},getDetails:function(e){this.$refs.dailyDetail.getList({monthly_report_time:e.monthly_report_time,idcard:e.idcard})},showModal:function(){this.$refs.approvalBatchModal.handleShow(this.selectedIdCards,this.selectedRows,"batch",this.monthlyReportTimeStr)}}},h=m,f=(r("a7c5"),r("2877")),b=Object(f["a"])(h,n,o,!1,null,"3c24851c",null);t["default"]=b.exports},d795:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticStyle:{"margin-bottom":"8px"}},[t("a-button",{attrs:{type:"primary",disabled:!e.hasSelected},on:{click:e.handleDailyApproval}},[e._v(" 批复 ")]),t("a-button",{staticStyle:{"margin-left":"8px"},attrs:{disabled:!e.hasSelected},on:{click:e.handleReject}},[e._v(" 一键驳回 ")]),t("span",{staticStyle:{"margin-left":"8px"}},[e.hasSelected?[e._v(" "+e._s("选择 ".concat(e.selectedRowKeys.length," 项"))+" ")]:e._e()],2)],1),t("a-table",{attrs:{bordered:"",size:"middle",columns:e.columns,rowKey:function(e,t){return t},"data-source":e.data,"row-selection":{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange,getCheckboxProps:e.getCheckboxProps,columnTitle:e.hideSelect?"选择":""},pagination:!1,loading:e.loading}}),t("approval-modal",{ref:"approvalModal",on:{ok:function(t){return e.getList(e.personnelInfo)}}})],1)},o=[],a=(r("4de4"),r("a15b"),r("d3b7"),r("159b"),r("46ad")),i=r("e788"),s=[{title:"PO Number",dataIndex:"poid",key:"poid",width:120},{title:"序号",dataIndex:"serial_number",key:"serial_number",width:80},{title:"内容",dataIndex:"job_description",key:"job_description",ellipsis:!0}],c={name:"ApprovalCard",components:{ApprovalModal:i["default"]},data:function(){return{data:[],columns:s,selectedRowKeys:[],clientHeight:800,personnelInfo:{},selectedIds:[],selectedRows:[],loading:!1,hideSelect:!1}},beforeCreate:function(){this.formDetail=this.$form.createForm(this)},mounted:function(){var e=this;this.clientHeight=document.body.clientHeight,window.onresize=function(){return function(){e.$nextTick((function(){e.clientHeight=document.body.clientHeight}))}()}},computed:{hasSelected:function(){return this.selectedRowKeys.length>0}},methods:{onSelectChange:function(e,t){var r=this;this.selectedRowKeys=e,this.selectedRows=t,this.selectedIds=[],t.forEach((function(e){r.selectedIds.push(e.id)}))},getCheckboxProps:function(e){return{props:{disabled:Boolean(e.poid)}}},getList:function(e){var t=this;this.selectedRowKeys=[],this.loading=!0,this.personnelInfo=e,Object(a["e"])(this.personnelInfo).then((function(e){"ok"===e.state&&(t.loading=!1,t.data=e.list,t.hideSelect=t.data.filter((function(e){return""!==e.poid||null===e.poid})).length>0)})).catch((function(){t.loading=!1}))},handleDailyApproval:function(){this.$refs.approvalModal.handleShow(this.selectedIds,this.selectedRows,"details")},handleReject:function(){var e=this,t=this.selectedIds.length>1?this.selectedIds.join(","):this.selectedIds.join();Object(a["c"])({id:t,poid:"00000000"}).then((function(t){"ok"===t.state?(e.$message.success("操作成功",2),e.getList(e.personnelInfo),e.$emit("ok")):e.$message.error("操作失败",2),e.visible=!1,e.confirmLoading=!1})).catch((function(){e.visible=!1,e.confirmLoading=!1}))}}},l=c,u=r("2877"),d=Object(u["a"])(l,n,o,!1,null,"60d0381d",null);t["default"]=d.exports},e29a:function(e,t,r){},e788:function(e,t,r){"use strict";r.r(t);r("b0c0");var n=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"批量批复",width:600,visible:e.visible,confirmLoading:e.confirmLoading,maskClosable:!1},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[t("a-form",{attrs:{form:e.form,layout:"horizontal"}},["batch"===e.flag?[e._l(e.data,(function(r,n){return[t("a-row",{key:n},[t("a-col",{attrs:{span:7}},[t("a-form-item",{attrs:{label:"填写人","label-col":{span:8},"wrapper-col":{span:16}}},[t("span",[e._v(" "+e._s(r.name))])])],1),t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{label:"可用package","label-col":{span:10},"wrapper-col":{span:14}}},[t("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["wtrcount[".concat(n,"]"),{initialValue:r.wtrcount,rules:[{required:!0,message:"请输入",whitespace:!0,type:"number"}]}],expression:"[\n                  `wtrcount[${index}]`,\n                  { initialValue: i.wtrcount,\n                    rules: [{\n                      required: true,\n                      message: '请输入',\n                      whitespace: true,\n                      type: 'number'\n                    }]\n                  }\n                ]"}]})],1)],1)],1),n<e.data.length?t("a-divider",{key:"line"+n,staticStyle:{margin:"0 0 8px 0"}}):e._e()]}))]:e._e(),t("a-row",[t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{label:"PO Number","label-col":{span:10},"wrapper-col":{span:14}}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["poid",{initialValue:"",rules:[{required:!0,message:"请输入8-10位数字",whitespace:!0,pattern:/^\d{8,10}$/}]}],expression:"[\n              'poid',\n              { initialValue: '',\n                rules: [{\n                  required: true,\n                  message: '请输入8-10位数字',\n                  whitespace: true,\n                  pattern: /^\\d{8,10}$/}]}\n            ]"}],attrs:{placeholder:"请输入"}})],1)],1)],1)],2)],1)},o=[],a=r("5530"),i=(r("a15b"),r("46ad")),s={name:"ApprovalModal",data:function(){return{confirmLoading:!1,visible:!1,data:[],flag:"batch",monthly:"",selectedRowKeys:[]}},beforeCreate:function(){this.form=this.$form.createForm(this)},methods:{handleShow:function(e,t,r,n){this.visible=!0,this.data=t,this.selectedRowKeys=e,this.flag=r,n&&(this.monthly=n),this.form.setFieldsValue({poid:""})},handleCancel:function(){this.visible=!1},handleSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFields((function(e,r){if(!e){t.confirmLoading=!0;var n=t.selectedRowKeys.length>1?t.selectedRowKeys.join(","):t.selectedRowKeys.join(),o="details"===t.flag?i["c"]:i["b"],s=Object(a["a"])({},r);"details"===t.flag?s.id=n:s.idcard=n,t.monthly&&(s.monthly_report_time=t.monthly),"batch"===t.flag&&(s.numbers=r.wtrcount.length>1?r.wtrcount.join(","):r.wtrcount.join(),delete s.wtrcount),o(s).then((function(e){"ok"===e.state?(t.$message.success("审批成功",2),t.$emit("ok")):t.$message.error("审批失败",2),t.visible=!1,t.confirmLoading=!1})).catch((function(){t.visible=!1,t.confirmLoading=!1}))}}))}}},c=s,l=(r("3926"),r("2877")),u=Object(l["a"])(c,n,o,!1,null,"7f471aea",null);t["default"]=u.exports}}]);