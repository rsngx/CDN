(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6bc2a2ac"],{"0fdb":function(t,e,r){"use strict";r("75a4")},"46ad":function(t,e,r){"use strict";r.d(e,"b",(function(){return o})),r.d(e,"f",(function(){return i})),r.d(e,"e",(function(){return l})),r.d(e,"c",(function(){return c})),r.d(e,"g",(function(){return u})),r.d(e,"l",(function(){return s})),r.d(e,"a",(function(){return p})),r.d(e,"h",(function(){return d})),r.d(e,"d",(function(){return m})),r.d(e,"k",(function(){return f})),r.d(e,"i",(function(){return b})),r.d(e,"j",(function(){return g}));var n=r("b775"),a={add:"mr/add_report",query:"mr/query",update:"mr/update_report",statistic:"mr/report_statistical",overview:"mr/detail_report",details:"mr/report_detail_query",updateInfo:"mr/update_info",getRole:"mr/role",getPersonnelInfo:"mr/approval_personnel_query",getDailyByPerson:"mr/approval_mr_query",approveDaily:"mr/approval_mr_update",approveBatch:"mr/approval_mr_update_batch"};function o(t){return Object(n["b"])({url:a.approveBatch,method:"post",params:t})}function i(t){return Object(n["b"])({url:a.getPersonnelInfo,method:"post",params:t})}function l(t){return Object(n["b"])({url:a.getDailyByPerson,method:"post",params:t})}function c(t){return Object(n["b"])({url:a.approveDaily,method:"post",params:t})}function u(t){return Object(n["b"])({url:a.getRole,method:"post",params:t})}function s(t){return Object(n["b"])({url:a.updateInfo,method:"post",params:t})}function p(t){return Object(n["b"])({url:a.add,method:"post",params:t})}function d(t){return Object(n["b"])({url:a.overview,method:"post",params:t})}function m(t){return Object(n["b"])({url:a.details,method:"post",params:t})}function f(t){return Object(n["b"])({url:a.update,method:"post",params:t})}function b(t){return Object(n["b"])({url:a.query,method:"post",params:t})}function g(t){return Object(n["b"])({url:a.statistic,method:"post",params:t})}},"75a4":function(t,e,r){},7816:function(t,e,r){"use strict";r.r(e);r("b0c0");var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"table-page-search-wrapper",staticStyle:{"margin-left":"12px","margin-top":"12px"}},[e("a-form",{attrs:{layout:"inline"}},[e("a-row",{attrs:{gutter:32}},[e("a-col",{attrs:{md:6,lg:5}},[e("a-form-item",{attrs:{label:"填写人"}},[e("a-input",{attrs:{placeholder:"请输入",allowClear:""},model:{value:t.queryItem.name,callback:function(e){t.$set(t.queryItem,"name",e)},expression:"queryItem.name"}})],1)],1),e("a-col",{attrs:{md:6,lg:5}},[e("a-form-item",{attrs:{label:"时间"}},[e("a-month-picker",{staticStyle:{width:"100%"},attrs:{format:"YYYY-MM"},model:{value:t.queryItem.daily_time,callback:function(e){t.$set(t.queryItem,"daily_time",e)},expression:"queryItem.daily_time"}})],1)],1),e("a-col",{attrs:{md:6,lg:5}},[e("a-form-item",{attrs:{label:"公司"}},[e("a-select",{attrs:{placeholder:"请选择",allowClear:t.allowClearVendor},model:{value:t.queryItem.vendor,callback:function(e){t.$set(t.queryItem,"vendor",e)},expression:"queryItem.vendor"}},t._l(t.vendorOptions,(function(r){return e("a-select-option",{key:r.dept_name},[t._v(t._s(r.dept_name))])})),1)],1)],1),e("a-col",{staticStyle:{"padding-right":"5px"},attrs:{md:5,lg:4}},[e("a-form-item",{attrs:{label:"项目"}},[e("a-select",{attrs:{placeholder:"请选择",allowClear:t.allowClearProject},on:{change:t.onChange},model:{value:t.queryItem.province,callback:function(e){t.$set(t.queryItem,"province",e)},expression:"queryItem.province"}},t._l(t.provinceOptions,(function(r){return e("a-select-option",{key:r},[t._v(" "+t._s(r)+" ")])})),1)],1)],1),e("a-col",{staticStyle:{"padding-left":"0px"},attrs:{md:4,lg:3}},[e("a-form-item",[e("a-select",{attrs:{placeholder:"请选择",allowClear:t.allowClearProject},on:{change:t.onChange},model:{value:t.queryItem.cbt,callback:function(e){t.$set(t.queryItem,"cbt",e)},expression:"queryItem.cbt"}},t._l(t.cbtOptions,(function(r){return e("a-select-option",{key:r},[t._v(" "+t._s(r)+" ")])})),1)],1)],1)],1),e("a-row",{attrs:{gutter:32}},[e("a-col",{attrs:{md:6,lg:5}},[e("a-form-item",{attrs:{label:"PO number"}},[e("a-input",{attrs:{allowClear:""},model:{value:t.queryItem.poid,callback:function(e){t.$set(t.queryItem,"poid",e)},expression:"queryItem.poid"}})],1)],1),e("a-col",{attrs:{md:6,lg:5,offset:12}},[e("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"right"}},[e("a-button",{staticStyle:{"margin-right":"8px"},attrs:{loading:t.loading,type:"primary"},on:{click:function(e){return t.getData({pageNo:1,pageSize:10})}}},[t._v("查询")]),e("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(){t.queryItem={}}}},[t._v("重置")]),e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{loading:t.exportLoading,type:"primary"},on:{click:t.exportListData}},[t._v("导出")])],1)])],1)],1),e("a-table",{ref:"table",staticStyle:{"margin-top":"20px"},attrs:{size:"middle",columns:t.columns,"data-source":t.data,rowKey:function(t,e){return e},pagination:t.pagination,loading:t.loading},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"job_responsibilities",fn:function(r){return[e("a-popover",{attrs:{content:r}},[e("span",{staticClass:"smileDark smileDark-120"},[t._v(t._s(r))])])]}},{key:"expandedRowRender",fn:function(r){return r.report_detail.length>0?e("a-table",{attrs:{columns:t.innerCol,"data-source":r.report_detail,pagination:!1,rowKey:function(t,e){return e}},scopedSlots:t._u([{key:"job_description",fn:function(r){return[e("a-popover",{attrs:{content:r}},[e("span",{staticClass:"smileDark smileDark-220"},[t._v(t._s(r))])])]}}],null,!1,562065728)}):t._e()}}],null,!0)})],1)},a=[],o=r("5530"),i=(r("99af"),r("4de4"),r("d81d"),r("b64b"),r("d3b7"),r("159b"),r("c32d")),l=r.n(i),c=r("2af9"),u=r("8ac3"),s=r("46ad"),p={daily_time:l()(new Date),vendor:"",name:"",province:"",cbt:""},d=[{align:"center",title:"填写人",dataIndex:"name",key:"name"},{align:"center",title:"公司",dataIndex:"vendor",key:"vendor"},{align:"center",title:"项目经理",dataIndex:"pm",key:"pm"},{align:"center",title:"项目经理邮箱",dataIndex:"pm_email",key:"pm_email"},{align:"center",title:"项目经理电话",dataIndex:"pm_mobile",key:"pm_mobile"},{align:"center",title:"工作职责",dataIndex:"job_responsibilities",key:"job_responsibilities",width:180,scopedSlots:{customRender:"job_responsibilities"}}],m=[{align:"center",title:"月份",dataIndex:"monthly_report_time",key:"monthly_report_time"},{align:"center",title:"序号",dataIndex:"serial_number",key:"serial_number"},{align:"center",title:"Package",dataIndex:"mr_level",key:"mr_level"},{align:"center",title:"工作简要描述",dataIndex:"job_description",key:"job_description",width:240,scopedSlots:{customRender:"job_description"}},{align:"center",title:"PO number",dataIndex:"poid",key:"poid"},{align:"center",title:"工作类别",dataIndex:"job_category",key:"job_category"},{align:"center",title:"工作地点",dataIndex:"working_place",key:"working_place"},{align:"center",title:"填写时间",dataIndex:"update_time",key:"update_time"},{align:"center",title:"提交IP",dataIndex:"ip_address",key:"ip_address"}],f={name:"StatDetails",components:{STable:c["l"]},data:function(){return{queryItem:p,vendorOptions:[],provinceOptions:[],cbtOptions:[],allowClearVendor:!0,pagination:{},dicArray:[],data:[],allowClearProject:!0,labelCol:{lg:{span:6},xs:{span:24},sm:{span:19}},wrapperCol:{lg:{span:18},xs:{span:24},sm:{span:19}},columns:d,innerCol:m,loading:!1,exportLoading:!1}},created:function(){var t=this;Object(s["g"])().then((function(e){var r=e.list;Object(u["n"])().then((function(e){r&&"vendor"===r.role?(t.allowClearVendor=!1,t.vendorOptions=e.data.filter((function(t){return r.permission.split(",").indexOf(t.dept_name)>-1})),t.queryItem.vendor=t.vendorOptions[0].dept_name):(t.allowClearVendor=!0,t.vendorOptions=e.data)})),Object(u["k"])().then((function(e){var n=[];e.data.forEach((function(t){n.push(t.dept_name)})),r&&"pm"===r.role?(t.allowClearProject=!1,t.provinceOptions=n.filter((function(t){var e=!1;return r.permission.split(",").forEach((function(r){r.indexOf(t)>-1&&(e=!0)})),!0===e})),t.queryItem.province=t.provinceOptions[0]):(t.allowClearProject=!0,t.provinceOptions=n)})),Object(u["e"])().then((function(e){t.dicArray=e.data,r&&"pm"===r.role?(t.allowClearProject=!1,t.cbtOptions=t.getDataByType("cbt").filter((function(t){var e=!1;return r.permission.split(",").forEach((function(r){r.indexOf(t)>-1&&(e=!0)})),!0===e})),t.queryItem.cbt=t.cbtOptions[0]):(t.allowClearProject=!0,t.cbtOptions=t.getDataByType("cbt"))}))})),this.getData({pageNo:1,pageSize:10})},methods:{handleTableChange:function(t,e,r){var n=Object(o["a"])({},this.pagination);n.pageNo=t.current,n.pageSize=t.pageSize,this.pagination=n,this.getData()},expand:function(t,e){},getData:function(t){var e=this;this.loading=!0;var r=t||this.pagination,n=this.handleParam();return Object(s["d"])(Object.assign({},r,n)).then((function(t){e.loading=!1;var r=Object(o["a"])({},e.pagination);r.total=t[0].totalCount,r.pageNo=t[0].pageNo,r.current=t[0].pageNo,e.pagination=r,e.data=t.map((function(t,e){if(0!==e)return t.report_detail&&t.report_detail.length>0&&t.report_detail.map((function(t){t.daily_time=l()(t.daily_time).format("YYYY-MM-DD")})),Object.assign({},t.info,{report_detail:t.report_detail})})),e.data.shift(e.data[0])})).catch((function(){e.loading=!1}))},getDataByType:function(t){var e=[];if(this.dicArray.length>0)return this.dicArray.forEach((function(r){r.dic_type===t&&e.push(r.dic_value)})),e},handleParam:function(){var t={},e=l()(this.queryItem.daily_time).format("L").split("/")[1],r=l()(this.queryItem.daily_time).year(),n=Object(o["a"])({},this.queryItem);delete n.daily_time;var a=e&&r?"P".concat(e,".Y").concat(r):"";return t=Object.assign({},n,{monthly_report_time:a}),t},exportListData:function(){var t=this;if(this.exportLoading=!0,!this.queryItem.daily_time)return this.$message.error("只能导出一个月的数据，请选择月份！"),void(this.exportLoading=!1);setTimeout((function(){t.exportLoading=!1}),3e3);for(var e="/api",r=Object.assign({},this.handleParam()),n="",a=Object.keys(r),o=0;o<a.length;o++)""!==r[a[o]]&&(n+=a[o]+"="+r[a[o]]+"&");window.location.href=e+"/mr/report_detail_export?"+n+"token="+this.$route.query.token},onChange:function(){}}},b=f,g=(r("0fdb"),r("2877")),y=Object(g["a"])(b,n,a,!1,null,"f08240aa",null);e["default"]=y.exports},"8ac3":function(t,e,r){"use strict";r.d(e,"i",(function(){return o})),r.d(e,"b",(function(){return i})),r.d(e,"h",(function(){return l})),r.d(e,"m",(function(){return c})),r.d(e,"j",(function(){return u})),r.d(e,"l",(function(){return s})),r.d(e,"g",(function(){return p})),r.d(e,"n",(function(){return d})),r.d(e,"q",(function(){return m})),r.d(e,"p",(function(){return f})),r.d(e,"e",(function(){return b})),r.d(e,"f",(function(){return g})),r.d(e,"k",(function(){return y})),r.d(e,"o",(function(){return h})),r.d(e,"a",(function(){return _})),r.d(e,"d",(function(){return v})),r.d(e,"r",(function(){return j})),r.d(e,"c",(function(){return O}));var n=r("b775"),a={query:"supplier/query",add:"supplier/add",deleteData:"supplier/del",update:"supplier/update",submit:"supplier/submit",audit:"supplier/audit",reject:"supplier/reject",getDicByType:"dict/getByType",getDicAll:"dict/all",getProvice:"org/province",getVendor:"/org/vendor",getAnylisisList:"/supplier/multi_statistics",getProjectStatic:"/supplier/project_statistical",getStatustics:"/supplier/level_statistical",getProjectsDetail:"/supplier/detail",getToDo:"/supplier/todo",getHnStatustics:"/supplier/Hn_level_statistical",addScore:"/score/add_score",updateScore:"/score/update_score",getPscore:"/score/detail_employees_score",getVscore:"/score/detail_supplier_score"};function o(t){return Object(n["b"])({url:a.getProjectStatic,method:"post",params:t})}function i(t){return Object(n["b"])({url:a.addScore,method:"post",params:t})}function l(t){return Object(n["b"])({url:a.getAnylisisList,method:"post",params:t})}function c(t){return Object(n["b"])({url:a.getToDo,method:"post",params:t})}function u(t){return Object(n["b"])({url:a.getProjectsDetail,method:"post",params:t})}function s(t){return Object(n["b"])({url:a.getStatustics,method:"post",params:t})}function p(t){return Object(n["b"])({url:a.getHnStatustics,method:"post",params:t})}function d(t){return Object(n["b"])({url:a.getVendor,method:"get",params:t})}function m(t){return Object(n["b"])({url:a.submit,method:"post",params:t})}function f(t){return Object(n["b"])({url:a.reject,method:"post",params:t})}function b(t){return Object(n["b"])({url:a.getDicAll,method:"get",params:t})}function g(t){return Object(n["b"])({url:a.getDicByType,method:"get",params:t})}function y(t){return Object(n["b"])({url:a.getProvice,method:"get",params:t})}function h(t){return Object(n["b"])({url:a.query,method:"post",params:t})}function _(t){return Object(n["b"])({url:a.add,method:"post",params:t})}function v(t){return Object(n["b"])({url:a.deleteData,method:"post",params:t})}function j(t){return Object(n["b"])({url:a.update,method:"post",params:t})}function O(t){return Object(n["b"])({url:a.audit,method:"post",params:t})}}}]);