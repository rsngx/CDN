(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4bee4ba3"],{"0187":function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"i",(function(){return o})),n.d(t,"a",(function(){return u})),n.d(t,"l",(function(){return c})),n.d(t,"m",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return m})),n.d(t,"j",(function(){return f})),n.d(t,"h",(function(){return h})),n.d(t,"b",(function(){return p})),n.d(t,"f",(function(){return b})),n.d(t,"g",(function(){return y})),n.d(t,"k",(function(){return g}));var r=n("b775"),s={page:"/common/page/portal.t_sys_role",roleListAll:"/role/listAll",add:"/role/add",update:"/role/update",delete:"/role/delete",assignUsers:"/role/assignUsers",getUsers:"/role/getUsers",listAll:"/user/listAll",assignMenus:"/role/assignMenus",role:"/role"},a="role_id,role_name,create_date,create_by,remark,status,security";function i(e){return Object(r["b"])({url:s.roleListAll,method:"post",params:e})}function o(e){e.fields=a;var t=[];if(e.role_name){var n={col:"role_name"};n.value="%"+e.role_name+"%",n.opt="like",t.push(n)}if(e.status){var i={col:"status"};i.value=e.status,i.opt="=",t.push(i)}return t.length>0&&(e.wheres=JSON.stringify([t])),e.orderBy="create_date desc,role_id desc",Object(r["b"])({url:s.page,method:"post",params:e})}function u(e){return Object(r["b"])({url:s.add,method:"post",params:e})}function c(e){var t={role_name:e.role_name,status:e.status,security:e.security,remark:e.remark};e.set=JSON.stringify(t);var n=[];if(e.role_id){var a={col:"role_id"};a.value=e.role_id,a.opt="=",n.push(a)}return n.length>0&&(e.wheres=JSON.stringify(n)),Object(r["b"])({url:s.update,method:"post",params:e})}function l(e){var t={status:e.status};e.set=JSON.stringify(t);var n=[];if(e.role_id){var a={col:"role_id"};a.value=e.role_id,a.opt="=",n.push(a)}return n.length>0&&(e.wheres=JSON.stringify(n)),Object(r["b"])({url:s.update,method:"post",params:e})}function d(e){var t={role_id:e.role_id};return Object(r["b"])({url:s.delete,method:"post",params:t})}function m(e){return Object(r["b"])({url:s.assignUsers,method:"post",data:e})}function f(e){return Object(r["b"])({url:s.getUsers,method:"get",params:e})}function h(e){return Object(r["b"])({url:s.listAll,method:"get",params:e})}function p(e){return Object(r["b"])({url:s.assignMenus,method:"post",params:e})}function b(e){e.fields="menu_id";var t=[];if(e.role_id){var n={col:"role_id"};n.value=e.role_id,n.opt="=",t.push(n)}return t.length>0&&(e.wheres=JSON.stringify([t])),Object(r["b"])({url:"common/query/portal.t_sys_role_menu",method:"post",params:e})}function y(e){e.fields="id";var t=[];if(e.menu_name){var n={col:"status",value:1,opt:"="};t.push(n)}return t.length>0&&(e.wheres=JSON.stringify([t])),Object(r["b"])({url:"common/query/portal.t_sys_sub_system",method:"post",params:e})}function g(e){return Object(r["b"])({url:"role/isAllowDelete",method:"post",params:e})}},"06c5":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));n("a630"),n("fb6a"),n("b0c0"),n("d3b7"),n("ac1f"),n("25f0"),n("3ca3");var r=n("6b75");function s(e,t){if(e){if("string"===typeof e)return Object(r["a"])(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(r["a"])(e,t):void 0}}},"5b64":function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"i",(function(){return u})),n.d(t,"k",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return m})),n.d(t,"h",(function(){return f})),n.d(t,"g",(function(){return h})),n.d(t,"f",(function(){return p})),n.d(t,"j",(function(){return b}));var r=n("b775"),s={page:"/common/page/portal.t_sys_menu",add:"/menu/add",delete:"/menu/delete",role:"/role"},a="menu_id,system_id,menu_url,component,parent_id,clazz,style,menu_name,create_date,create_by,level,sort_no,status";function i(e){e.fields=a;var t=[];if(e.menu_name){var n={col:"menu_name"};n.value=e.menu_name,n.opt="=",t.push(n)}return t.length>0&&(e.wheres=JSON.stringify([t])),Object(r["b"])({url:s.page,method:"post",params:e})}function o(e){return delete e.system_name,Object(r["b"])({url:s.add,method:"post",params:e})}function u(e){return Object(r["b"])({url:"/menu/update",method:"post",params:e})}function c(e){var t={status:e.status};e.set=JSON.stringify(t);var n=[];if(e.menu_id){var a={col:"menu_id"};a.value=e.menu_id,a.opt="=",n.push(a)}return n.length>0&&(e.wheres=JSON.stringify(n)),Object(r["b"])({url:s.update,method:"post",params:e})}function l(e){var t={menuId:e.menu_id};return Object(r["b"])({url:s.delete,method:"post",params:t})}function d(e){return Object(r["b"])({url:"menu/getMenuTree",method:"get",params:e})}function m(e){return Object(r["b"])({url:"menu/getDirectoryMenuTree",method:"get",params:e})}function f(e){return Object(r["b"])({url:"menu/queryMenuTree",method:"get",params:e})}function h(e){return Object(r["b"])({url:"menu/getSystems",method:"get",params:e})}function p(e){return Object(r["b"])({url:"menu/getSubMenus",method:"get",params:e})}function b(e){return Object(r["b"])({url:"menu/updateSortNo",method:"post",params:e})}},"6b75":function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,"a",(function(){return r}))},b85c:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));n("a4d3"),n("e01a"),n("d28b"),n("d3b7"),n("3ca3"),n("ddb0");var r=n("06c5");function s(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Object(r["a"])(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var s=0,a=function(){};return{s:a,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){u=!0,i=e},f:function(){try{o||null==n["return"]||n["return"]()}finally{if(u)throw i}}}}},fc73:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:800,visible:e.visible,confirmLoading:e.confirmLoading},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[t("a-form",{attrs:{form:e.form},on:{submit:e.handleSubmit}},[t("a-row",{staticClass:"form-row",attrs:{gutter:16}},[t("a-col",{staticStyle:{"min-height":"400px","max-height":"400px",overflow:"auto"},attrs:{span:12}},[t("div",{staticClass:"box-header"},[t("div",{staticClass:"box-title"},[t("i",{staticClass:"fa icon-grid"}),e._v(" 所属系统 ")]),t("div",{staticClass:"box-tools pull-right"})]),e.systemTree.length?t("a-tree",{ref:"systems",attrs:{showLine:"",defaultExpandAll:"",treeData:e.systemTree,defaultExpandParent:""},on:{select:this.onSelect},scopedSlots:e._u([{key:"custom",fn:function(e){var n=e.selected;return[t("a-icon",{attrs:{type:n?"frown":"frown-o"}})]}}],null,!1,3196988677)},[t("a-icon",{attrs:{slot:"switcherIcon",type:"down"},slot:"switcherIcon"}),t("a-icon",{attrs:{slot:"smile",type:"smile-o"},slot:"smile"}),t("a-icon",{attrs:{slot:"meh",type:"smile-o"},slot:"meh"})],1):e._e()],1),t("a-col",{staticStyle:{"border-left":"1px solid #eee","padding-left":"20px","min-height":"400px","max-height":"400px",overflow:"auto"},attrs:{span:12}},[t("a-spin",{attrs:{spinning:e.loading}},[t("a-form-item",{attrs:{label:"请选择菜单权限"}},[e.treeData.length?t("a-tree",{ref:"menuTree",attrs:{checkable:"",treeDefaultExpandAll:"",defaultExpandAll:"",expandedKeys:e.expandedKeys,autoExpandParent:e.autoExpandParent,selectedKeys:e.selectedKeys,treeData:e.treeData},on:{expand:e.onExpand,check:e.onCheck},model:{value:e.checkedKeys,callback:function(t){e.checkedKeys=t},expression:"checkedKeys"}}):t("a-empty")],1)],1)],1)],1)],1)],1)},s=[],a=n("b85c"),i=(n("4de4"),n("a434"),n("b64b"),n("d3b7"),n("159b"),n("5b64")),o=n("0187"),u={name:"AssignMenu",data:function(){return{form:this.$form.createForm(this),confirmLoading:!1,visible:!1,loading:!1,title:"",systemTree:[],system_id:0,expandedKeys:[],autoExpandParent:!0,checkedKeys:[],commitCheckedKeys:[],selectedKeys:[],treeData:[]}},watch:{checkedKeys:function(e){}},created:function(){this.getSystems(),this.getExpandedKeys({})},methods:{getSystems:function(){var e=this;Object(i["g"])().then((function(t){e.systemTree=t,e.menuTree({t:new Date,system_id:e.system_id})}))},getCheckedKeys:function(e){var t=this;return Object(o["f"])(e).then((function(e){if(e.result){var n=JSON.parse(e.result);n.forEach((function(e){t.checkedKeys.push(e.menu_id)}))}t.commitCheckedKeys=t.checkedKeys}))},getExpandedKeys:function(e){var t=this;return this.expandedKeys=[],Object(o["g"])(e).then((function(e){if(e.result){var n=JSON.parse(e.result);n.forEach((function(e){t.expandedKeys.push("system_"+e.id)}))}}))},menuTree:function(e){var t=this;return this.loading=!0,Object(i["e"])(e).then((function(e){t.treeData=e,t.loading=!1}))},add:function(e){this.checkedKeys=[],this.commitCheckedKeys=[],this.getCheckedKeys({role_id:e.role_id}),this.role_id=e.role_id,this.title="分配菜单",this.visible=!0},onExpand:function(e){this.expandedKeys=e,this.autoExpandParent=!1},dealChildren:function(e){var t,n=Object(a["a"])(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,s=r.value,i=this.commitCheckedKeys.indexOf(s);i>-1&&this.commitCheckedKeys.splice(i,1),r.children&&this.dealChildren(r.children)}}catch(o){n.e(o)}finally{n.f()}},onCheck:function(e,t){var n,r=this.commitCheckedKeys,s=[],i=Object(a["a"])(r);try{for(i.s();!(n=i.n()).done;){var o=n.value,u=this.checkedKeys.indexOf(o);-1===u&&s.push(o)}}catch(h){i.e(h)}finally{i.f()}this.commitCheckedKeys=this.commitCheckedKeys.filter((function(e){return-1===s.indexOf(e)}));var c,l=Object(a["a"])(t.checkedNodes);try{for(l.s();!(c=l.n()).done;){var d=c.value,m=d.data.props;"2"===m.clazz&&-1===this.commitCheckedKeys.indexOf(m.menu_id)&&this.commitCheckedKeys.push(m.menu_id)}}catch(h){l.e(h)}finally{l.f()}var f={};f.role_id=this.role_id,f.menus=this.commitCheckedKeys},onSelect:function(e,t){this.selectedKeys=e,this.system_id=e[0],this.menuTree({t:new Date,system_id:this.system_id}),this.checkedKeys=this.commitCheckedKeys},handleSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFields((function(e,n){if(!e)return n.role_id=t.role_id,n.menus=t.commitCheckedKeys,Object(o["b"])(Object.assign(n)).then((function(e){"ok"===e.state?(t.visible=!1,t.$emit("ok",n)):t.$error({title:"错误提示",content:e.msg||e.message})}))}))},handleCancel:function(){this.visible=!1}}},c=u,l=n("2877"),d=Object(l["a"])(c,r,s,!1,null,"1fff9f84",null);t["default"]=d.exports}}]);