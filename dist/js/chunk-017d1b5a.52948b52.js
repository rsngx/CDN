(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-017d1b5a","chunk-2dac6a84","chunk-ac79af5a","chunk-4bee4ba3","chunk-bf8634b8"],{"0187":function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"i",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"l",(function(){return c})),n.d(t,"m",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"j",(function(){return h})),n.d(t,"h",(function(){return m})),n.d(t,"b",(function(){return p})),n.d(t,"f",(function(){return b})),n.d(t,"g",(function(){return y})),n.d(t,"k",(function(){return g}));var r=n("b775"),a={page:"/common/page/portal.t_sys_role",roleListAll:"/role/listAll",add:"/role/add",update:"/role/update",delete:"/role/delete",assignUsers:"/role/assignUsers",getUsers:"/role/getUsers",listAll:"/user/listAll",assignMenus:"/role/assignMenus",role:"/role"},s="role_id,role_name,create_date,create_by,remark,status,security";function i(e){return Object(r["b"])({url:a.roleListAll,method:"post",params:e})}function o(e){e.fields=s;var t=[];if(e.role_name){var n={col:"role_name"};n.value="%"+e.role_name+"%",n.opt="like",t.push(n)}if(e.status){var i={col:"status"};i.value=e.status,i.opt="=",t.push(i)}return t.length>0&&(e.wheres=JSON.stringify([t])),e.orderBy="create_date desc,role_id desc",Object(r["b"])({url:a.page,method:"post",params:e})}function l(e){return Object(r["b"])({url:a.add,method:"post",params:e})}function c(e){var t={role_name:e.role_name,status:e.status,security:e.security,remark:e.remark};e.set=JSON.stringify(t);var n=[];if(e.role_id){var s={col:"role_id"};s.value=e.role_id,s.opt="=",n.push(s)}return n.length>0&&(e.wheres=JSON.stringify(n)),Object(r["b"])({url:a.update,method:"post",params:e})}function u(e){var t={status:e.status};e.set=JSON.stringify(t);var n=[];if(e.role_id){var s={col:"role_id"};s.value=e.role_id,s.opt="=",n.push(s)}return n.length>0&&(e.wheres=JSON.stringify(n)),Object(r["b"])({url:a.update,method:"post",params:e})}function d(e){var t={role_id:e.role_id};return Object(r["b"])({url:a.delete,method:"post",params:t})}function f(e){return Object(r["b"])({url:a.assignUsers,method:"post",data:e})}function h(e){return Object(r["b"])({url:a.getUsers,method:"get",params:e})}function m(e){return Object(r["b"])({url:a.listAll,method:"get",params:e})}function p(e){return Object(r["b"])({url:a.assignMenus,method:"post",params:e})}function b(e){e.fields="menu_id";var t=[];if(e.role_id){var n={col:"role_id"};n.value=e.role_id,n.opt="=",t.push(n)}return t.length>0&&(e.wheres=JSON.stringify([t])),Object(r["b"])({url:"common/query/portal.t_sys_role_menu",method:"post",params:e})}function y(e){e.fields="id";var t=[];if(e.menu_name){var n={col:"status",value:1,opt:"="};t.push(n)}return t.length>0&&(e.wheres=JSON.stringify([t])),Object(r["b"])({url:"common/query/portal.t_sys_sub_system",method:"post",params:e})}function g(e){return Object(r["b"])({url:"role/isAllowDelete",method:"post",params:e})}},"0236":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:600,visible:e.visible,confirmLoading:e.confirmLoading},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[t("a-card",{attrs:{bordered:!1}},[t("a-form",{attrs:{form:e.form},on:{submit:e.handleSubmit}},[t("a-form-item",{attrs:{label:"角色名称",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["role_name",{rules:[{required:!0,message:"请输入角色名称",whitespace:!0}]}],expression:"[\n            'role_name',\n            {rules: [{ required: true, message: '请输入角色名称', whitespace: true}]}\n          ]"}],attrs:{placeholder:"请输入角色名称"}})],1),t("a-form-item",{attrs:{label:"角色权限",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["security",{initialValue:"1"}],expression:"['security',\n                        {\n                          initialValue: '1'\n                        }]"}]},[t("a-radio",{attrs:{value:"1"}},[e._v("公司")]),t("a-radio",{attrs:{value:"2"}},[e._v("项目经理")]),t("a-radio",{attrs:{value:"3"}},[e._v("管理员")])],1)],1),t("a-form-item",{attrs:{label:"状态",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["status",{initialValue:"1"}],expression:"['status',\n                        {\n                          initialValue: '1'\n                        }]"}]},[t("a-radio",{attrs:{value:"1"}},[e._v("启用")]),t("a-radio",{attrs:{value:"0"}},[e._v("禁用")])],1)],1),t("a-form-item",{attrs:{label:"备注",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark",{rules:[{message:"",whitespace:!0}]}],expression:"[\n            'remark',\n            {rules: [{ message: '', whitespace: true}]}\n          ]"}],attrs:{rows:"6"}},[t("a-icon",{attrs:{slot:"suffix",type:"setting"},slot:"suffix"})],1)],1)],1)],1)],1)},a=[],s=(n("d3b7"),n("25f0"),n("0187")),i={data:function(){return{value:1,isEdit:!1,title:"",role_id:"",labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}},visible:!1,confirmLoading:!1,form:this.$form.createForm(this)}},methods:{add:function(){this.form.resetFields(),this.isEdit=!1,this.title="新建角色",this.visible=!0},edit:function(e){this.isEdit=!0,this.title="编辑角色",this.visible=!0,this.role_id=e.role_id,e.status=e.status.toString();var t=this.form.setFieldsValue;this.$nextTick((function(){t(e)}))},handleSubmit:function(e){var t=this;e.preventDefault(),this.confirmLoading=!0,this.form.validateFields((function(e,n){if(!e)return t.isEdit?(n.role_id=t.role_id,Object(s["l"])(Object.assign(n)).then((function(e){"ok"===e.state?(t.visible=!1,t.confirmLoading=!1,t.$emit("ok",n)):t.$error({title:"错误提示",content:e.msg})}))):Object(s["a"])(Object.assign(n)).then((function(e){"ok"===e.state?(t.visible=!1,t.$emit("ok",n)):t.$error({title:"错误提示",content:e.msg})}))}))},handleCancel:function(){this.visible=!1}}},o=i,l=n("2877"),c=Object(l["a"])(o,r,a,!1,null,null,null);t["default"]=c.exports},"06c5":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n("a630"),n("fb6a"),n("b0c0"),n("d3b7"),n("ac1f"),n("25f0"),n("3ca3");var r=n("6b75");function a(e,t){if(e){if("string"===typeof e)return Object(r["a"])(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(r["a"])(e,t):void 0}}},1216:function(e,t,n){"use strict";n.d(t,"g",(function(){return s})),n.d(t,"i",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"j",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"f",(function(){return h})),n.d(t,"h",(function(){return m}));var r=n("b775"),a={service:"/service",permissionNoPager:"/permission/no-pager",orgTree:"/org/getOrgTree",queryTree:"/org/queryOrgTree",add:"/org/add",update:"/org/update",delete:"/org/delete",subTree:"/org/getSubOrgTree"};function s(e){return Object(r["b"])({url:a.orgTree,method:"get",params:e})}function i(e){return Object(r["b"])({url:a.queryTree,method:"get",params:e})}function o(e){return Object(r["b"])({url:a.add,method:"post",params:e})}function l(e){return Object(r["b"])({url:a.update,method:"post",params:e})}function c(e){return Object(r["b"])({url:a.delete,method:"get",params:e})}function u(e){return Object(r["b"])({url:"org/assignRoles",method:"post",params:e})}function d(e){return Object(r["b"])({url:"/org/getRoles",method:"get",params:e})}function f(e){return Object(r["b"])({url:"role/assignOrgs",method:"post",params:e})}function h(e){e.fields="dept_id";var t=[];if(e.role_id){var n={col:"role_id"};n.value=e.role_id,n.opt="=",t.push(n)}return t.length>0&&(e.wheres=JSON.stringify([t])),Object(r["b"])({url:"common/query/portal.t_sys_role_dept",method:"post",params:e})}function m(e){return Object(r["b"])({url:"org/isAllowDelete",method:"post",params:e})}},2909:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("6b75");function a(e){if(Array.isArray(e))return Object(r["a"])(e)}n("a4d3"),n("e01a"),n("d28b"),n("a630"),n("d3b7"),n("3ca3"),n("ddb0");function s(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var i=n("06c5");function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e){return a(e)||s(e)||Object(i["a"])(e)||o()}},"49fe":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:480,bodyStyle:{maxHeight:"400px",overflow:"auto"},visible:e.visible,confirmLoading:e.confirmLoading},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[t("a-card",{attrs:{bordered:!1}},[t("a-form",{attrs:{form:e.form},on:{submit:e.handleSubmit}},[t("a-row",{staticClass:"form-row"},[t("a-col",{attrs:{span:24}},[t("a-form-item",{attrs:{label:"请选择部门"}},[e.treeData.length?t("a-tree",{attrs:{checkable:"",checkStrictly:"",treeDefaultExpandAll:"",defaultExpandAll:"",expandedKeys:e.expandedKeys,autoExpandParent:e.autoExpandParent,selectedKeys:e.selectedKeys,treeData:e.treeData},on:{expand:e.onExpand,select:e.onSelect,check:e.onCheck},model:{value:e.checkedKeys,callback:function(t){e.checkedKeys=t},expression:"checkedKeys"}}):e._e()],1)],1)],1)],1)],1)],1)},a=[],s=n("b85c"),i=(n("b64b"),n("d3b7"),n("159b"),n("1216")),o=[{title:"0-0",key:"0-0",children:[{title:"0-0-0",key:"0-0-0",children:[{title:"0-0-0-0",key:"0-0-0-0"},{title:"0-0-0-1",key:"0-0-0-1"},{title:"0-0-0-2",key:"0-0-0-2"}]},{title:"0-0-1",key:"0-0-1",children:[{title:"0-0-1-0",key:"0-0-1-0"},{title:"0-0-1-1",key:"0-0-1-1"},{title:"0-0-1-2",key:"0-0-1-2"}]},{title:"0-0-2",key:"0-0-2"}]},{title:"0-1",key:"0-1",children:[{title:"0-1-0-0",key:"0-1-0-0"},{title:"0-1-0-1",key:"0-1-0-1"},{title:"0-1-0-2",key:"0-1-0-2"}]},{title:"0-2",key:"0-2"}],l={name:"AssignMenu",data:function(){return{form:this.$form.createForm(this),confirmLoading:!1,visible:!1,title:"",expandedKeys:[],autoExpandParent:!0,checkedKeys:[],selectedKeys:[],treeData:o}},created:function(){this.orgTree()},methods:{getCheckedKeys:function(e){var t=this;return this.checkedKeys=[],Object(i["f"])(e).then((function(e){if(e.result){var n=JSON.parse(e.result);n.forEach((function(e){t.checkedKeys.push(e.dept_id)}))}}))},orgTree:function(e){var t=this;return Object(i["g"])(e).then((function(e){t.treeData=e}))},add:function(e){this.getCheckedKeys({role_id:e.role_id}),this.role_id=e.role_id,this.title="分配部门",this.visible=!0},onExpand:function(e){this.expandedKeys=e,this.autoExpandParent=!1},onCheck:function(e,t){},getChildren:function(e){if(e.length>0){var t,n=Object(s["a"])(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.checkedKeys.push(r.dept_id),this.onCheck(r.dept_id),this.getChildren(r.children)}}catch(a){n.e(a)}finally{n.f()}}},onSelect:function(e,t){this.selectedKeys=e},handleSubmit:function(e){var t=this;e.preventDefault();var n={};return n.role_id=this.role_id,this.checkedKeys.checked?n.orgs=this.checkedKeys.checked:n.orgs=this.checkedKeys,Object(i["b"])(Object.assign(n)).then((function(e){"ok"===e.state?(t.visible=!1,t.$emit("ok",n)):t.$error({title:"错误提示",content:e.msg})}))},handleCancel:function(){this.visible=!1}}},c=l,u=(n("f628"),n("2877")),d=Object(u["a"])(c,r,a,!1,null,"f734efe8",null);t["default"]=d.exports},"4a12":function(e,t,n){"use strict";n("a952")},"53a2":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:700,bodyStyle:{maxHeight:"400px",minHeight:"360px",overflow:"auto"},visible:e.visible},on:{cancel:e.handleCancel}},[t("template",{slot:"footer"},[t("a-button",{key:"back",on:{click:e.handleCancel}},[e._v("取消")]),t("a-button",{key:"submit",attrs:{type:"primary",loading:e.loading},on:{click:e.handleSubmit}},[e._v(" 提交 ")])],1),t("a-spin",{attrs:{spinning:e.Loading}},[e.isReset?t("a-transfer",{attrs:{"data-source":e.dataSource,"show-search":"","filter-option":e.filterOption,"target-keys":e.targetKeys,selectedKeys:e.selectedKeys,render:function(e){return e.title},listStyle:{height:"300px",flex:1}},on:{selectChange:e.handleSelectChange,change:e.handleChange,search:e.handleSearch}}):e._e()],1)],2)},a=[],s=n("2909"),i=n("5530"),o=(n("99af"),n("d81d"),n("d3b7"),n("07ac"),n("159b"),n("5880")),l=n("0187"),c={name:"AssignUsersTransfer",data:function(){return{Loading:!1,isReset:!1,visible:!1,title:"",loading:!1,selectedKeys:[],dataSource:[],targetKeys:[],roleId:null,roleUserId:[]}},computed:Object(i["a"])({},Object(o["mapGetters"])(["userInfo"])),created:function(){this.selfDeptId=this.userInfo.dept_id,this.account=this.userInfo.account,this.getTreeData(this.selfDeptId)},methods:{show:function(e){},add:function(e){var t=this;this.isReset=!1,this.roleId=e.role_id,this.targetKeys=[],this.selectedKeys=[],this.getUser(),this.title="分配用户",this.$nextTick((function(){t.isReset=!0})),this.visible=!0},handleCancel:function(){this.visible=!1},handleSubmit:function(e){var t=this;e.preventDefault(),this.loading=!0;var n={role_id:this.roleId,users:this.targetKeys};Object(l["c"])(n).then((function(e){t.loading=!1,"ok"===e.state&&(t.visible=!1)}))},filterOption:function(e,t){return t.title.indexOf(e)>-1},handleChange:function(e,t,n){this.targetKeys=e},handleSelectChange:function(e,t){this.selectedKeys=[].concat(Object(s["a"])(e),Object(s["a"])(t))},handleSearch:function(e,t){},onChange:function(e){this.targetKeys=e},getTreeData:function(){var e=this;Object(l["h"])().then((function(t){if("ok"===t.state){var n={};t.data.forEach((function(e){n[e.user_id]={key:e.user_id+"",title:"".concat(e.user_name," - ").concat(e.account," - ").concat(e.dept_name),description:e.account,deptName:e.dept_name,chosen:!1}})),e.dataSource=Object.values(n)}}))},getUser:function(){var e=this;this.Loading=!0,Object(l["j"])({roleId:this.roleId}).then((function(t){e.Loading=!1,"ok"===t.state&&(e.targetKeys=t.users.map((function(e){return e.user_id+""})))}))}}},u=c,d=(n("4a12"),n("2877")),f=Object(d["a"])(u,r,a,!1,null,"d7a669fc",null);t["default"]=f.exports},"5b64":function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"i",(function(){return l})),n.d(t,"k",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"h",(function(){return h})),n.d(t,"g",(function(){return m})),n.d(t,"f",(function(){return p})),n.d(t,"j",(function(){return b}));var r=n("b775"),a={page:"/common/page/portal.t_sys_menu",add:"/menu/add",delete:"/menu/delete",role:"/role"},s="menu_id,system_id,menu_url,component,parent_id,clazz,style,menu_name,create_date,create_by,level,sort_no,status";function i(e){e.fields=s;var t=[];if(e.menu_name){var n={col:"menu_name"};n.value=e.menu_name,n.opt="=",t.push(n)}return t.length>0&&(e.wheres=JSON.stringify([t])),Object(r["b"])({url:a.page,method:"post",params:e})}function o(e){return delete e.system_name,Object(r["b"])({url:a.add,method:"post",params:e})}function l(e){return Object(r["b"])({url:"/menu/update",method:"post",params:e})}function c(e){var t={status:e.status};e.set=JSON.stringify(t);var n=[];if(e.menu_id){var s={col:"menu_id"};s.value=e.menu_id,s.opt="=",n.push(s)}return n.length>0&&(e.wheres=JSON.stringify(n)),Object(r["b"])({url:a.update,method:"post",params:e})}function u(e){var t={menuId:e.menu_id};return Object(r["b"])({url:a.delete,method:"post",params:t})}function d(e){return Object(r["b"])({url:"menu/getMenuTree",method:"get",params:e})}function f(e){return Object(r["b"])({url:"menu/getDirectoryMenuTree",method:"get",params:e})}function h(e){return Object(r["b"])({url:"menu/queryMenuTree",method:"get",params:e})}function m(e){return Object(r["b"])({url:"menu/getSystems",method:"get",params:e})}function p(e){return Object(r["b"])({url:"menu/getSubMenus",method:"get",params:e})}function b(e){return Object(r["b"])({url:"menu/updateSortNo",method:"post",params:e})}},"6b75":function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,"a",(function(){return r}))},a952:function(e,t,n){},b85c:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n("a4d3"),n("e01a"),n("d28b"),n("d3b7"),n("3ca3"),n("ddb0");var r=n("06c5");function a(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Object(r["a"])(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,s=function(){};return{s:s,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n["return"]||n["return"]()}finally{if(l)throw i}}}}},e78e:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("a-card",{attrs:{bordered:!1}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"}},[t("a-row",{attrs:{gutter:48}},[t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{label:"角色名称"}},[t("a-input",{attrs:{placeholder:""},model:{value:e.queryParam.role_name,callback:function(t){e.$set(e.queryParam,"role_name",t)},expression:"queryParam.role_name"}})],1)],1),t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{label:"是否启用"}},[t("a-select",{attrs:{"default-value":"0",placeholder:"请选择"},model:{value:e.queryParam.status,callback:function(t){e.$set(e.queryParam,"status",t)},expression:"queryParam.status"}},[t("a-select-option",{attrs:{value:""}},[e._v("全部")]),t("a-select-option",{attrs:{value:"1"}},[e._v("启用")]),t("a-select-option",{attrs:{value:"0"}},[e._v("禁用")])],1)],1)],1),t("a-col",{attrs:{md:e.advanced?24:8,sm:24}},[t("span",{staticClass:"table-page-search-submitButtons",style:e.advanced&&{float:"right",overflow:"hidden"}||{}},[t("a-button",{attrs:{type:"primary"},on:{click:e.handleQuery}},[e._v("查询")]),t("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(){return e.queryParam={}}}},[e._v("重置")]),t("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:function(t){return e.$refs.createModal.add()}}},[e._v("添加")])],1)])],1)],1)],1),t("s-table",{ref:"table",attrs:{columns:e.columns,data:e.loadData,scroll:{x:900},rowKey:"key",showPagination:"auto",size:"default"},scopedSlots:e._u([{key:"serial",fn:function(n,r,a){return t("span",{},[e._v(" "+e._s(a+1)+" ")])}},{key:"status",fn:function(n){return t("span",{},[t("a-badge",{attrs:{status:e._f("statusTypeFilter")(n),text:e._f("statusFilter")(n)}})],1)}},{key:"clazz",fn:function(n){return t("span",{},[t("a-badge",{attrs:{clazz:e._f("clazzTypeFilter")(n),text:e._f("clazzFilter")(n)}})],1)}},{key:"description",fn:function(n){return t("span",{},[t("ellipsis",{attrs:{pageSize:4,tooltip:""}},[e._v(e._s(n))])],1)}},{key:"action",fn:function(n,r){return t("span",{},[[e.$auth("sys:role:update")?t("a",{staticStyle:{color:"#52c41a"},on:{click:function(t){return e.handleEdit(r)}}},[e._v("编辑")]):e._e(),""!==r.parent_id?t("a-divider",{attrs:{type:"vertical"}}):e._e(),e.$auth("sys:role:delete")&&""!==r.parent_id?t("a",{staticStyle:{color:"red"},on:{click:function(t){return e.handleDelete(r)}}},[e._v("删除")]):e._e(),t("a-divider",{attrs:{type:"vertical"}})],t("a-dropdown",[t("a",{staticClass:"ant-dropdown-link"},[e._v("更多 "),t("a-icon",{attrs:{type:"down"}})],1),t("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[1===r.status?t("a-menu-item",[t("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.handleStatus(r,!1)}}},[e._v("禁用")])]):t("a-menu-item",[t("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.handleStatus(r,!0)}}},[e._v("启用")])]),e.$auth("sys:role:assignMenus")&&1===r.status?t("a-menu-item",[t("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.handleAssignMenus(r)}}},[e._v("分配菜单")])]):e._e(),e.$auth("sys:role:assignOrgs")&&1===r.status?t("a-menu-item",[t("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.handleAssignOrgs(r)}}},[e._v("分配部门")])]):e._e(),e.$auth("sys:role:assignUsers")&&1===r.status?t("a-menu-item",[t("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.handleAssignUsers(r)}}},[e._v("分配用户")])]):e._e()],1)],1)],2)}}])}),t("role-form",{ref:"createModal",on:{ok:e.handleOk}}),t("assign-menus",{ref:"assignMenus",on:{ok:e.assignMenus}}),t("assign-users",{ref:"assignUsers",on:{ok:e.assignUsers}}),t("assign-orgs",{ref:"assignOrgs",on:{ok:e.assignOrgs}})],1)},a=[],s=n("c32d"),i=n.n(s),o=n("2af9"),l=n("0236"),c=n("fc73"),u=n("53a2"),d=n("49fe"),f=n("0187"),h={0:{status:"default",text:"禁用"},1:{status:"processing",text:"启用"}},m={name:"RoleList",components:{AssignMenus:c["default"],AssignOrgs:d["default"],STable:o["l"],Ellipsis:o["c"],RoleForm:l["default"],AssignUsers:u["default"]},data:function(){var e=this;return{mdl:{},advanced:!1,queryParam:{},columns:[{title:"角色名称",dataIndex:"role_name",width:"220px"},{title:"备注",dataIndex:"remark",width:"400px"},{title:"状态",dataIndex:"status",sorter:!0,scopedSlots:{customRender:"status"},width:"100px"},{title:"操作",dataIndex:"action",width:"180px",scopedSlots:{customRender:"action"}}],loadData:function(t){return Object(f["i"])(Object.assign(t,e.queryParam)).then((function(e){return e.result}))},selectedRowKeys:[],selectedRows:[],visiblePwd:!1,resetPwdStatus:!1,optionAlertShow:!1}},filters:{statusFilter:function(e){return h[e].text},statusTypeFilter:function(e){return h[e].status},clazzFilter:function(e){return h[e].text},clazzTypeFilter:function(e){return h[e].clazz}},created:function(){},methods:{tableOption:function(){var e=this;this.optionAlertShow?(this.options={alert:!1,rowSelection:null},this.optionAlertShow=!1):(this.options={alert:{show:!0,clear:function(){e.selectedRowKeys=[]}},rowSelection:{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange,getCheckboxProps:function(e){return{props:{disabled:"No 2"===e.no,name:e.no}}}}},this.optionAlertShow=!0)},handleQuery:function(){this.$refs.table.loadData(this.localPagination,this.queryParam)},handleEdit:function(e){this.$refs.createModal.edit(e)},handleDelete:function(e){var t=this;Object(f["k"])(e).then((function(n){n.isAllowDelete?t.$confirm({centered:!0,title:"信息提示",content:"你确定要删除角色【"+e.role_name+"】吗？",onOk:function(){Object(f["d"])(e).then((function(e){t.handleOk({})}))},onCancel:function(){return!1}}):t.$error({centered:!0,title:"信息提示",content:n.msg})}))},handleAssignMenus:function(e){this.$refs.assignMenus.add(e)},handleAssignOrgs:function(e){this.$refs.assignOrgs.add(e)},handleAssignUsers:function(e){this.$refs.assignUsers.add(e)},assignMenus:function(e){this.$success({centered:!0,title:"信息提示",content:"操作成功"})},assignOrgs:function(e){this.$success({centered:!0,title:"信息提示",content:"操作成功"})},assignUsers:function(e){this.$success({centered:!0,title:"信息提示",content:"操作成功"})},handleOk:function(e){this.$success({title:"信息提示",centered:!0,content:"操作成功"}),this.$refs.table.refresh()},handleStatus:function(e,t){var n=this;return e.status=t?"1":"0",Object(f["m"])(Object.assign(e)).then((function(e){"ok"===e.state?(n.visible=!1,n.$success({centered:!0,title:"信息提示",content:"操作成功"}),n.$refs.table.loadData(n.localPagination,{dept_id:n.dept_id},n.queryParam)):n.$error({centered:!0,title:"错误提示",content:e.msg})}))},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},toggleAdvanced:function(){this.advanced=!this.advanced},resetSearchForm:function(){this.queryParam={date:i()(new Date)}}}},p=m,b=n("2877"),y=Object(b["a"])(p,r,a,!1,null,null,null);t["default"]=y.exports},e9be:function(e,t,n){},f628:function(e,t,n){"use strict";n("e9be")},fc73:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:800,visible:e.visible,confirmLoading:e.confirmLoading},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[t("a-form",{attrs:{form:e.form},on:{submit:e.handleSubmit}},[t("a-row",{staticClass:"form-row",attrs:{gutter:16}},[t("a-col",{staticStyle:{"min-height":"400px","max-height":"400px",overflow:"auto"},attrs:{span:12}},[t("div",{staticClass:"box-header"},[t("div",{staticClass:"box-title"},[t("i",{staticClass:"fa icon-grid"}),e._v(" 所属系统 ")]),t("div",{staticClass:"box-tools pull-right"})]),e.systemTree.length?t("a-tree",{ref:"systems",attrs:{showLine:"",defaultExpandAll:"",treeData:e.systemTree,defaultExpandParent:""},on:{select:this.onSelect},scopedSlots:e._u([{key:"custom",fn:function(e){var n=e.selected;return[t("a-icon",{attrs:{type:n?"frown":"frown-o"}})]}}],null,!1,3196988677)},[t("a-icon",{attrs:{slot:"switcherIcon",type:"down"},slot:"switcherIcon"}),t("a-icon",{attrs:{slot:"smile",type:"smile-o"},slot:"smile"}),t("a-icon",{attrs:{slot:"meh",type:"smile-o"},slot:"meh"})],1):e._e()],1),t("a-col",{staticStyle:{"border-left":"1px solid #eee","padding-left":"20px","min-height":"400px","max-height":"400px",overflow:"auto"},attrs:{span:12}},[t("a-spin",{attrs:{spinning:e.loading}},[t("a-form-item",{attrs:{label:"请选择菜单权限"}},[e.treeData.length?t("a-tree",{ref:"menuTree",attrs:{checkable:"",treeDefaultExpandAll:"",defaultExpandAll:"",expandedKeys:e.expandedKeys,autoExpandParent:e.autoExpandParent,selectedKeys:e.selectedKeys,treeData:e.treeData},on:{expand:e.onExpand,check:e.onCheck},model:{value:e.checkedKeys,callback:function(t){e.checkedKeys=t},expression:"checkedKeys"}}):t("a-empty")],1)],1)],1)],1)],1)],1)},a=[],s=n("b85c"),i=(n("4de4"),n("a434"),n("b64b"),n("d3b7"),n("159b"),n("5b64")),o=n("0187"),l={name:"AssignMenu",data:function(){return{form:this.$form.createForm(this),confirmLoading:!1,visible:!1,loading:!1,title:"",systemTree:[],system_id:0,expandedKeys:[],autoExpandParent:!0,checkedKeys:[],commitCheckedKeys:[],selectedKeys:[],treeData:[]}},watch:{checkedKeys:function(e){}},created:function(){this.getSystems(),this.getExpandedKeys({})},methods:{getSystems:function(){var e=this;Object(i["g"])().then((function(t){e.systemTree=t,e.menuTree({t:new Date,system_id:e.system_id})}))},getCheckedKeys:function(e){var t=this;return Object(o["f"])(e).then((function(e){if(e.result){var n=JSON.parse(e.result);n.forEach((function(e){t.checkedKeys.push(e.menu_id)}))}t.commitCheckedKeys=t.checkedKeys}))},getExpandedKeys:function(e){var t=this;return this.expandedKeys=[],Object(o["g"])(e).then((function(e){if(e.result){var n=JSON.parse(e.result);n.forEach((function(e){t.expandedKeys.push("system_"+e.id)}))}}))},menuTree:function(e){var t=this;return this.loading=!0,Object(i["e"])(e).then((function(e){t.treeData=e,t.loading=!1}))},add:function(e){this.checkedKeys=[],this.commitCheckedKeys=[],this.getCheckedKeys({role_id:e.role_id}),this.role_id=e.role_id,this.title="分配菜单",this.visible=!0},onExpand:function(e){this.expandedKeys=e,this.autoExpandParent=!1},dealChildren:function(e){var t,n=Object(s["a"])(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,a=r.value,i=this.commitCheckedKeys.indexOf(a);i>-1&&this.commitCheckedKeys.splice(i,1),r.children&&this.dealChildren(r.children)}}catch(o){n.e(o)}finally{n.f()}},onCheck:function(e,t){var n,r=this.commitCheckedKeys,a=[],i=Object(s["a"])(r);try{for(i.s();!(n=i.n()).done;){var o=n.value,l=this.checkedKeys.indexOf(o);-1===l&&a.push(o)}}catch(m){i.e(m)}finally{i.f()}this.commitCheckedKeys=this.commitCheckedKeys.filter((function(e){return-1===a.indexOf(e)}));var c,u=Object(s["a"])(t.checkedNodes);try{for(u.s();!(c=u.n()).done;){var d=c.value,f=d.data.props;"2"===f.clazz&&-1===this.commitCheckedKeys.indexOf(f.menu_id)&&this.commitCheckedKeys.push(f.menu_id)}}catch(m){u.e(m)}finally{u.f()}var h={};h.role_id=this.role_id,h.menus=this.commitCheckedKeys},onSelect:function(e,t){this.selectedKeys=e,this.system_id=e[0],this.menuTree({t:new Date,system_id:this.system_id}),this.checkedKeys=this.commitCheckedKeys},handleSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFields((function(e,n){if(!e)return n.role_id=t.role_id,n.menus=t.commitCheckedKeys,Object(o["b"])(Object.assign(n)).then((function(e){"ok"===e.state?(t.visible=!1,t.$emit("ok",n)):t.$error({title:"错误提示",content:e.msg||e.message})}))}))},handleCancel:function(){this.visible=!1}}},c=l,u=n("2877"),d=Object(u["a"])(c,r,a,!1,null,"1fff9f84",null);t["default"]=d.exports}}]);