(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-78ec9eec","chunk-3095e62e"],{3926:function(e,t,n){"use strict";n("e29a")},"46ad":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"g",(function(){return c})),n.d(t,"l",(function(){return d})),n.d(t,"a",(function(){return u})),n.d(t,"h",(function(){return p})),n.d(t,"d",(function(){return h})),n.d(t,"k",(function(){return m})),n.d(t,"i",(function(){return f})),n.d(t,"j",(function(){return b}));var a=n("b775"),o={add:"mr/add_report",query:"mr/query",update:"mr/update_report",statistic:"mr/report_statistical",overview:"mr/detail_report",details:"mr/report_detail_query",updateInfo:"mr/update_info",getRole:"mr/role",getPersonnelInfo:"mr/approval_personnel_query",getDailyByPerson:"mr/approval_mr_query",approveDaily:"mr/approval_mr_update",approveBatch:"mr/approval_mr_update_batch"};function r(e){return Object(a["b"])({url:o.approveBatch,method:"post",params:e})}function i(e){return Object(a["b"])({url:o.getPersonnelInfo,method:"post",params:e})}function s(e){return Object(a["b"])({url:o.getDailyByPerson,method:"post",params:e})}function l(e){return Object(a["b"])({url:o.approveDaily,method:"post",params:e})}function c(e){return Object(a["b"])({url:o.getRole,method:"post",params:e})}function d(e){return Object(a["b"])({url:o.updateInfo,method:"post",params:e})}function u(e){return Object(a["b"])({url:o.add,method:"post",params:e})}function p(e){return Object(a["b"])({url:o.overview,method:"post",params:e})}function h(e){return Object(a["b"])({url:o.details,method:"post",params:e})}function m(e){return Object(a["b"])({url:o.update,method:"post",params:e})}function f(e){return Object(a["b"])({url:o.query,method:"post",params:e})}function b(e){return Object(a["b"])({url:o.statistic,method:"post",params:e})}},d795:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticStyle:{"margin-bottom":"8px"}},[t("a-button",{attrs:{type:"primary",disabled:!e.hasSelected},on:{click:e.handleDailyApproval}},[e._v(" 批复 ")]),t("a-button",{staticStyle:{"margin-left":"8px"},attrs:{disabled:!e.hasSelected},on:{click:e.handleReject}},[e._v(" 一键驳回 ")]),t("span",{staticStyle:{"margin-left":"8px"}},[e.hasSelected?[e._v(" "+e._s("选择 ".concat(e.selectedRowKeys.length," 项"))+" ")]:e._e()],2)],1),t("a-table",{attrs:{bordered:"",size:"middle",columns:e.columns,rowKey:function(e,t){return t},"data-source":e.data,"row-selection":{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange,getCheckboxProps:e.getCheckboxProps,columnTitle:e.hideSelect?"选择":""},pagination:!1,loading:e.loading}}),t("approval-modal",{ref:"approvalModal",on:{ok:function(t){return e.getList(e.personnelInfo)}}})],1)},o=[],r=(n("4de4"),n("a15b"),n("d3b7"),n("159b"),n("46ad")),i=n("e788"),s=[{title:"PO Number",dataIndex:"poid",key:"poid",width:120},{title:"序号",dataIndex:"serial_number",key:"serial_number",width:80},{title:"内容",dataIndex:"job_description",key:"job_description",ellipsis:!0}],l={name:"ApprovalCard",components:{ApprovalModal:i["default"]},data:function(){return{data:[],columns:s,selectedRowKeys:[],clientHeight:800,personnelInfo:{},selectedIds:[],selectedRows:[],loading:!1,hideSelect:!1}},beforeCreate:function(){this.formDetail=this.$form.createForm(this)},mounted:function(){var e=this;this.clientHeight=document.body.clientHeight,window.onresize=function(){return function(){e.$nextTick((function(){e.clientHeight=document.body.clientHeight}))}()}},computed:{hasSelected:function(){return this.selectedRowKeys.length>0}},methods:{onSelectChange:function(e,t){var n=this;this.selectedRowKeys=e,this.selectedRows=t,this.selectedIds=[],t.forEach((function(e){n.selectedIds.push(e.id)}))},getCheckboxProps:function(e){return{props:{disabled:Boolean(e.poid)}}},getList:function(e){var t=this;this.selectedRowKeys=[],this.loading=!0,this.personnelInfo=e,Object(r["e"])(this.personnelInfo).then((function(e){"ok"===e.state&&(t.loading=!1,t.data=e.list,t.hideSelect=t.data.filter((function(e){return""!==e.poid||null===e.poid})).length>0)})).catch((function(){t.loading=!1}))},handleDailyApproval:function(){this.$refs.approvalModal.handleShow(this.selectedIds,this.selectedRows,"details")},handleReject:function(){var e=this,t=this.selectedIds.length>1?this.selectedIds.join(","):this.selectedIds.join();Object(r["c"])({id:t,poid:"00000000"}).then((function(t){"ok"===t.state?(e.$message.success("操作成功",2),e.getList(e.personnelInfo),e.$emit("ok")):e.$message.error("操作失败",2),e.visible=!1,e.confirmLoading=!1})).catch((function(){e.visible=!1,e.confirmLoading=!1}))}}},c=l,d=n("2877"),u=Object(d["a"])(c,a,o,!1,null,"60d0381d",null);t["default"]=u.exports},e29a:function(e,t,n){},e788:function(e,t,n){"use strict";n.r(t);n("b0c0");var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"批量批复",width:600,visible:e.visible,confirmLoading:e.confirmLoading,maskClosable:!1},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[t("a-form",{attrs:{form:e.form,layout:"horizontal"}},["batch"===e.flag?[e._l(e.data,(function(n,a){return[t("a-row",{key:a},[t("a-col",{attrs:{span:7}},[t("a-form-item",{attrs:{label:"填写人","label-col":{span:8},"wrapper-col":{span:16}}},[t("span",[e._v(" "+e._s(n.name))])])],1),t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{label:"可用package","label-col":{span:10},"wrapper-col":{span:14}}},[t("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["wtrcount[".concat(a,"]"),{initialValue:n.wtrcount,rules:[{required:!0,message:"请输入",whitespace:!0,type:"number"}]}],expression:"[\n                  `wtrcount[${index}]`,\n                  { initialValue: i.wtrcount,\n                    rules: [{\n                      required: true,\n                      message: '请输入',\n                      whitespace: true,\n                      type: 'number'\n                    }]\n                  }\n                ]"}]})],1)],1)],1),a<e.data.length?t("a-divider",{key:"line"+a,staticStyle:{margin:"0 0 8px 0"}}):e._e()]}))]:e._e(),t("a-row",[t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{label:"PO Number","label-col":{span:10},"wrapper-col":{span:14}}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["poid",{initialValue:"",rules:[{required:!0,message:"请输入8-10位数字",whitespace:!0,pattern:/^\d{8,10}$/}]}],expression:"[\n              'poid',\n              { initialValue: '',\n                rules: [{\n                  required: true,\n                  message: '请输入8-10位数字',\n                  whitespace: true,\n                  pattern: /^\\d{8,10}$/}]}\n            ]"}],attrs:{placeholder:"请输入"}})],1)],1)],1)],2)],1)},o=[],r=n("5530"),i=(n("a15b"),n("46ad")),s={name:"ApprovalModal",data:function(){return{confirmLoading:!1,visible:!1,data:[],flag:"batch",monthly:"",selectedRowKeys:[]}},beforeCreate:function(){this.form=this.$form.createForm(this)},methods:{handleShow:function(e,t,n,a){this.visible=!0,this.data=t,this.selectedRowKeys=e,this.flag=n,a&&(this.monthly=a),this.form.setFieldsValue({poid:""})},handleCancel:function(){this.visible=!1},handleSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFields((function(e,n){if(!e){t.confirmLoading=!0;var a=t.selectedRowKeys.length>1?t.selectedRowKeys.join(","):t.selectedRowKeys.join(),o="details"===t.flag?i["c"]:i["b"],s=Object(r["a"])({},n);"details"===t.flag?s.id=a:s.idcard=a,t.monthly&&(s.monthly_report_time=t.monthly),"batch"===t.flag&&(s.numbers=n.wtrcount.length>1?n.wtrcount.join(","):n.wtrcount.join(),delete s.wtrcount),o(s).then((function(e){"ok"===e.state?(t.$message.success("审批成功",2),t.$emit("ok")):t.$message.error("审批失败",2),t.visible=!1,t.confirmLoading=!1})).catch((function(){t.visible=!1,t.confirmLoading=!1}))}}))}}},l=s,c=(n("3926"),n("2877")),d=Object(c["a"])(l,a,o,!1,null,"7f471aea",null);t["default"]=d.exports}}]);